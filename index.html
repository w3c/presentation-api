<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="UTF-8">
    <title>
      Presentation API
    </title>
    <script src="https://www.w3.org/Tools/respec/respec-w3c-common" async
    class="remove">
    </script>
    <script class="remove">
    var respecConfig = {
        specStatus: 'ED',
        edDraftURI: 'https://w3c.github.io/presentation-api/',
        shortName:  'presentation-api',
        editors: [
          {
            w3cid: 68454,
            name: 'Mark Foltz',
            company: 'Google',
            mailto: 'mfoltz@google.com'
          },
          {
            w3cid: 63802,
            name: 'Dominik RÃ¶ttsches',
            company: 'Intel',
            note: 'until April 2015'
          }
        ],
        previousMaturity: 'WD',
        previousPublishDate: '2016-05-10',
        otherLinks: [
          {
            key: 'Version history',
            data: [
              {
                value: 'GitHub w3c/presentation-api/commits',
                href: 'https://github.com/w3c/presentation-api/commits/'
              }
            ]
          },
          {
            key: 'Test suite',
            data: [
              {
                value: 'GitHub web-platform-tests/presentation-api',
                href: 'https://github.com/w3c/web-platform-tests/tree/master/presentation-api'
              },
              {
                value: 'w3c-test.org/presentation-api/',
                href: 'http://w3c-test.org/presentation-api/'
              }
            ]
          },
          {
            key: 'Participate',
            data: [
              {
                value: 'GitHub w3c/presentation-api',
                href: 'https://github.com/w3c/presentation-api/'
              },
              {
                value: 'File an issue',
                href: 'https://github.com/w3c/presentation-api/issues/new'
              },
              {
                value: 'Open issues',
                href: 'https://github.com/w3c/presentation-api/issues/'
              },
              {
                value: 'Mailing-list (public-secondscreen@w3.org)',
                href: 'https://lists.w3.org/Archives/Public/public-secondscreen/'
              }
            ]
          }
        ],
        sotdAfterWGinfo: true,
        wg: 'Second Screen Presentation Working Group',
        wgURI: 'http://www.w3.org/2014/secondscreen/',
        wgPublicList: 'public-secondscreen',
        wgPatentURI: 'http://www.w3.org/2004/01/pp-impl/74168/status',
        localBiblio: {
          PROMGUIDE: {
            title: 'Writing Promise-Using Specifications',
            href: 'http://www.w3.org/2001/tag/doc/promises-guide',
            authors: [
              'Domenic Denicola'
            ],
            status: 'finding',
            publisher: 'W3C'
          },
          DIAL: {
            title: 'DIscovery And Launch Protocol Specification',
            href: 'http://www.dial-multiscreen.org/dial-protocol-specification',
            authors: [
              'Netflix',
              'YouTube'
            ],
            publisher: 'Netflix'
          }
        },
        crEnd: '2016-09-12',
        implementationReportURI: 'https://www.w3.org/wiki/Second_Screen/Implementation_Status#Tests'
      };
    </script>
    <style>
    /* Note formatting taken from HTML5 spec */
    .note { border-left-style: solid; border-left-width: 0.25em; background: none repeat scroll 0 0 #E9FBE9; border-color: #52E052; }
    .note em, .warning em, .note i, .warning i { font-style: normal; }
    p.note, div.note { padding: 0.5em 2em; }
    span.note { padding: 0 2em; }
    .note p:first-child { margin-top: 0; }
    .note p:last-child { margin-bottom: 0; }
    p.note:before { content: 'NOTE: '; }
    .non-normative { border-left-style: solid; border-left-width: 0.25em; background: none repeat scroll 0 0 #E9FBE9; border-color: #52E052; }
    p.non-normative:before { content: 'Non-normative: '; font-weight: bolder;}
    p.non-normative, div.non-normative { padding: 0.5em 2em; }

    .algorithm li {
        margin-bottom: 0.5em;
    }

    .interface dd, .parameters dt {
        margin-bottom: 0.5em;
    }

    code { color: orangered; }
    table { border-collapse: collapse; border-style: hidden hidden none hidden; }
    table thead, table tbody { border-bottom: solid; }
    table td, table th { border-left: solid; border-right: solid; border-bottom: solid thin; vertical-align: top; padding: 0.2em; }
    dfn { font-weight: bolder; font-style: normal; }
    var { hyphens: none; }
    .copyright { font-size: small; }
    .issue[id^='issue-'] > *:not([role='heading']) { display: none; }
    </style>
  </head>
  <body>
    <section id="abstract">
      <p>
        This specification defines an API to enable web content to access
        external presentation-type displays and use them for presenting web
        content.
      </p>
    </section>
    <section id="sotd">
      <p>
        Since publication as Candidate Recommendation on <a href=
        "http://www.w3.org/TR/2016/CR-presentation-api-20160714/">14 July
        2016</a>, the Working Group updated most algorithms in the spec to fix
        issues identified through testing and implementation feedback.
        Interfaces defined in this document did not change, except
        <code>PresentationConnectionClosedReason</code> and
        <code>PresentationConnectionClosedEvent</code>, which were renamed to
        improve consistency with the rest of the Web platform. See the <a href=
        "#changes-since-14-july-2016">list of changes</a> for details.
      </p>
      <p>
        No feature has been identified as being <strong>at risk</strong>.
        However, the working group notes that it expects the definitions in the
        <a href="#sandboxing-and-the-allow-presentation-keyword"></a> section
        to be integrated in HTML (see <a href=
        "https://github.com/w3c/html/issues/437">issue #437</a> in the Web
        Platform Working Group issue tracker) and dropped from this
        specification.
      </p>
      <p>
        The Second Screen Presentation Working Group will complete the <a href=
        "http://w3c-test.org/presentation-api/">test suite</a> for the
        Presentation API during the Candidate Recommendation period and update
        the <a href=
        "https://www.w3.org/wiki/Second_Screen/Implementation_Status#Tests">preliminary
        implementation report</a>. For this specification to advance to
        Proposed Recommendation, two independent, interoperable implementations
        of each feature must be demonstrated, as detailed in the <a href=
        "#h-cr-exit-criteria">CR exit criteria</a> section.
      </p>
    </section>
    <section class="informative">
      <h2>
        Introduction
      </h2>
      <p>
        This specification aims to make <a>presentation displays</a> such as
        projectors or connected TVs, available to the Web and takes into
        account displays that are attached using wired (HDMI, DVI, or similar)
        and wireless technologies (Miracast, Chromecast, DLNA, AirPlay, or
        similar).
      </p>
      <p>
        Devices with limited screen size lack the ability to show content to a
        larger audience, for example, a group of colleagues in a conference
        room, or friends and family at home. Showing content on an external
        large <a>presentation display</a> helps to improve the perceived
        quality and impact of the presented content.
      </p>
      <p>
        At its core, this specification enables an exchange of messages between
        a page that acts as the <a>controller</a> and another page that
        represents the <a href=
        "#dfn-receiving-browsing-context">presentation</a> shown in the
        <a>presentation display</a>. How the messages are transmitted is left
        to the UA in order to allow the use of <a>presentation display</a>
        devices that can be attached in a wide variety of ways. For example,
        when a <a>presentation display</a> device is attached using HDMI or
        Miracast, the same UA that acts as the <a>controller</a> renders the
        <a href="#dfn-receiving-browsing-context">presentation</a>. Instead of
        displaying the <a href=
        "#dfn-receiving-browsing-context">presentation</a> in another window on
        the same device, however, it can use whatever means the operating
        system provides for using the external <a>presentation displays</a>. In
        such a case, both the <a>controller</a> and <a href=
        "#dfn-receiving-browsing-context">presentation</a> run on the same UA
        and the operating system is used to route the <a>presentation
        display</a> output to the <a>presentation display</a>. This is commonly
        referred to as the <dfn><b id="1-ua">1-UA</b></dfn> case. This
        specification imposes no requirements on the <a>presentation
        display</a> devices connected in such a manner.
      </p>
      <p>
        If the <a>presentation display</a> is able to render HTML documents and
        communicate with the <a>controller</a>, the <a>controller</a> does not
        need to render the <a href=
        "#dfn-receiving-browsing-context">presentation</a>. In this case, the
        UA acts as a proxy that requests the <a>presentation display</a> to
        show and render the <a href=
        "#dfn-receiving-browsing-context">presentation</a> itself. This is
        commonly referred to as the <b id="2-ua">2-UA</b> case. This way of
        attaching to displays could be enhanced in the future by defining a
        standard protocol for delivering these types of messages that display
        devices could choose to implement.
      </p>
      <p>
        The API defined here is intended to be used with UAs that attach to
        <a>presentation display</a> devices through any of the above means.
      </p>
    </section>
    <section id="use-cases-and-requirements" class="informative">
      <h2>
        Use cases and requirements
      </h2>
      <p>
        Use cases and requirements are captured in a separate <a href=
        "https://github.com/w3c/presentation-api/blob/gh-pages/uc-req.md">Presentation
        API Use Cases and Requirements</a> document.
      </p>
    </section>
    <section id="conformance">
      <p>
        Requirements phrased in the imperative as part of algorithms (such as
        "strip any leading space characters" or "return false and terminate
        these steps") are to be interpreted with the meaning of the key word
        ("MUST", "SHOULD", "MAY", etc.) used in introducing the algorithm.
      </p>
      <p>
        Conformance requirements phrased as algorithms or specific steps may be
        implemented in any manner, so long as the result is equivalent. (In
        particular, the algorithms defined in this specification are intended
        to be easy to follow, and not intended to be performant.)
      </p>
      <section>
        <h3>
          Conformance Classes
        </h3>
        <p>
          This specification describes the conformance criteria for two classes
          of <dfn data-lt="user agent">user agents</dfn>.
        </p>
        <dl>
          <dt>
            <dfn>Controlling user agent</dfn>
          </dt>
          <dd>
            <p>
              Web browsers that conform to the specifications of a
              <a>controlling user agent</a> must be able to start and control
              presentations by providing a <a>controlling browsing context</a>
              as described in this specification. This context implements the
              <a><code>Presentation</code></a>,
              <a><code>PresentationAvailability</code></a>,
              <a><code>PresentationConnection</code></a>,
              <a><code>PresentationConnectionAvailableEvent</code></a>,
              <a><code>PresentationConnectionCloseEvent</code></a>, and
              <a><code>PresentationRequest</code></a> interfaces.
            </p>
          </dd>
          <dt>
            <dfn>Receiving user agent</dfn>
          </dt>
          <dd>
            <p>
              Web browsers that conform to the specifications of a <a>receiving
              user agent</a> must be able to render presentations by providing
              a <a>receiving browsing context</a> as described in this
              specification. This context implements the
              <a><code>Presentation</code></a>,
              <a><code>PresentationConnection</code></a>,
              <a><code>PresentationConnectionAvailableEvent</code></a>,
              <a><code>PresentationConnectionCloseEvent</code></a>,
              <a><code>PresentationConnectionList</code></a>, and
              <a><code>PresentationReceiver</code></a> interfaces.
            </p>
          </dd>
        </dl>
        <p>
          One user agent may act both as a <a>controlling user agent</a> and as
          a <a>receiving user agent</a>, if it provides both browsing contexts
          and implements all of their required interfaces. This can happen when
          the same user agent is able to host the <a>controlling browsing
          context</a> and the <a>receiving browsing context</a> for a
          presentation, as in the <a>1-UA</a> implementation of the API.
        </p>
        <p>
          Conformance requirements phrased against a <a>user agent</a> apply
          either to a <a>controlling user agent</a>, a <a>receiving user
          agent</a> or to both classes, depending on the context.
        </p>
      </section>
    </section>
    <section>
      <h2>
        Terminology
      </h2>
      <p>
        The following terms are defined in [[!HTML51]]:
      </p>
      <ul>
        <li>
          <dfn><a href=
          "https://www.w3.org/TR/html51/browsers.html#active-sandboxing-flag-set">
          active sandboxing flag set</a></dfn>
        </li>
        <li>
          <dfn><a href=
          "https://www.w3.org/TR/html51/browsers.html#allowed-to-show-a-popup">allowed
          to show a popup</a></dfn>
        </li>
        <li>
          <dfn><a href=
          "https://www.w3.org/TR/html51/obsolete.html#application-cache-manifest">
          application cache</a></dfn>
        </li>
        <li>
          <dfn data-lt="browsing context|browsing contexts"><a href=
          "https://www.w3.org/TR/html51/browsers.html#browsing-context">browsing
          context</a></dfn>
        </li>
        <li>
          <dfn><a href=
          "https://www.w3.org/TR/html51/browsers.html#creating-a-new-browsing-context">
          creating a new browsing context</a></dfn>
        </li>
        <li>
          <dfn><a href=
          "https://www.w3.org/TR/html51/webappapis.html#current">current
          realm</a></dfn>
        </li>
        <li>
          <dfn><a href=
          "http://www.w3.org/TR/html51/webappapis.html#current-settings-object">
          current settings object</a></dfn>
        </li>
        <li>
          <a href=
          "https://www.w3.org/TR/html51/webappapis.html#events-event-handlers"><dfn>
          <code>EventHandler</code></dfn></a>
        </li>
        <li>
          <dfn><a href=
          "https://www.w3.org/TR/html51/webappapis.html#event-handler">event
          handler</a></dfn>
        </li>
        <li>
          <dfn><a href=
          "https://www.w3.org/TR/html51/webappapis.html#event-handler-event-type">
          event handler event type</a></dfn>
        </li>
        <li>
          <dfn data-lt="fire|fires"><a href=
          "https://www.w3.org/TR/html51/infrastructure.html#fire">firing an
          event</a></dfn>
        </li>
        <li>
          <dfn data-lt="fire a simple event"><a href=
          "https://www.w3.org/TR/html51/webappapis.html#firing-a-simple-event-named-e">
          firing a simple event</a></dfn>
        </li>
        <li>
          <dfn><a href=
          "https://www.w3.org/TR/html51/infrastructure.html#in-parallel">in
          parallel</a></dfn>
        </li>
        <li>
          <dfn><a href=
          "https://www.w3.org/TR/html51/browsers.html#list-of-the-descendant-browsing-contexts">
          list of descendant browsing contexts</a></dfn>
        </li>
        <li>
          <dfn><a href=
          "https://www.w3.org/TR/html51/browsers.html#navigated">navigate</a></dfn>
        </li>
        <li>
          <a href=
          "https://www.w3.org/TR/html51/webappapis.html#navigator-navigator"><dfn>
          <code>Navigator</code></dfn></a>
        </li>
        <li>
          <dfn><a href=
          "https://www.w3.org/TR/html51/browsers.html#nested-browsing-contexts">
          nested browsing context</a></dfn>
        </li>
        <li>
          <dfn><a href=
          "https://www.w3.org/TR/html51/browsers.html#parse-the-sandboxing-directive">
          parse a sandboxing directive</a></dfn>
        </li>
        <li>
          <dfn><a href=
          "https://www.w3.org/TR/html51/webappapis.html#queuing">queue a
          task</a></dfn>
        </li>
        <li>
          <dfn><a href=
          "http://www.w3.org/TR/html51/webappapis.html#relevant-settings-object">
          relevant settings object</a></dfn>
        </li>
        <li>
          <dfn><a href=
          "https://www.w3.org/TR/html51/webappapis.html#responsible-browsing-context">
          responsible browsing context</a></dfn>
        </li>
        <li>
          <dfn><a href=
          "https://www.w3.org/TR/html51/browsers.html#sandboxed-auxiliary-navigation-browsing-context-flag">
          sandboxed auxiliary navigation browsing context flag</a></dfn>
        </li>
        <li>
          <dfn><a href=
          "https://www.w3.org/TR/html51/browsers.html#sandboxed-top-level-navigation-browsing-context-flag">
          sandboxed top-level navigation browsing context flag</a></dfn>
        </li>
        <li>
          <dfn><a href=
          "https://www.w3.org/TR/html51/browsers.html#sandboxing-flag-set">sandboxing
          flag set</a></dfn>
        </li>
        <li>
          <dfn><a href=
          "https://www.w3.org/TR/html51/browsers.html#session-history">session
          history</a></dfn>
        </li>
        <li>
          <dfn><a href=
          "https://www.w3.org/TR/html51/webappapis.html#task-source">task
          source</a></dfn>
        </li>
        <li>
          <dfn><a href=
          "https://www.w3.org/TR/html51/browsers.html#top-level-browsing-context">
          top-level browsing context</a></dfn>
        </li>
        <li>
          <dfn><a href=
          "https://www.w3.org/TR/html51/infrastructure.html#trusted">trusted
          event</a></dfn>
        </li>
        <li>
          <dfn><a href=
          "https://www.w3.org/TR/html51/browsers.html#unloaded">unload a
          document</a></dfn>
        </li>
      </ul>
      <p>
        The term <dfn><a href=
        "https://tc39.github.io/ecma262/#sec-code-realms">JavaScript
        realm</a></dfn> is defined in [[!ECMASCRIPT]].
      </p>
      <p>
        The terms <a href=
        "https://dom.spec.whatwg.org/#eventtarget"><dfn><code>EventTarget</code></dfn></a>,
        <a href=
        "https://dom.spec.whatwg.org/#event"><dfn><code>Event</code></dfn></a>,
        <a href=
        "https://dom.spec.whatwg.org/#dictdef-eventinit"><dfn><code>EventInit</code></dfn></a>
        are defined in [[!DOM]].
      </p>
      <p>
        The term <a href=
        "https://www.w3.org/TR/webmessaging/#messageevent"><dfn><code>MessageEvent</code></dfn></a>
        is defined in [[!WEBMESSAGING]].
      </p>
      <p>
        This document provides interface definitions using the Web IDL standard
        [[!WEBIDL-1]].
      </p>
      <p>
        The terms <dfn><a href=
        "https://heycam.github.io/webidl/#dfn-throw">throw</a></dfn>,
        <dfn><a href=
        "https://heycam.github.io/webidl/#idl-promise">Promise</a></dfn>,
        <dfn><a href=
        "https://heycam.github.io/webidl/#idl-ArrayBuffer">ArrayBuffer</a></dfn>,
        <dfn><a href=
        "https://heycam.github.io/webidl/#idl-ArrayBufferView">ArrayBufferView</a></dfn>,
        and the following exception names are defined in [[!WEBIDL-1]]:
      </p>
      <ul>
        <li>
          <a href=
          "https://heycam.github.io/webidl/#invalidaccesserror"><dfn><code>InvalidAccessError</code></dfn></a>
        </li>
        <li>
          <a href=
          "https://heycam.github.io/webidl/#notfounderror"><dfn><code>NotFoundError</code></dfn></a>
        </li>
        <li>
          <a href=
          "https://heycam.github.io/webidl/#notsupportederror"><dfn><code>NotSupportedError</code></dfn></a>
        </li>
        <li>
          <a href=
          "https://heycam.github.io/webidl/#operationerror"><dfn><code>OperationError</code></dfn></a>
        </li>
        <li>
          <a href=
          "https://heycam.github.io/webidl/#securityerror"><dfn><code>SecurityError</code></dfn></a>
        </li>
        <li>
          <a href=
          "https://heycam.github.io/webidl/#syntaxerror"><dfn><code>SyntaxError</code></dfn></a>
        </li>
        <li>
          <a href=
          "https://heycam.github.io/webidl/#notallowederror"><dfn><code>NotAllowedError</code></dfn></a>,
          defined in [[!WEBIDL-2]]
        </li>
      </ul>
      <p>
        The terms <dfn data-lt="resolve"><a href=
        "http://www.w3.org/2001/tag/doc/promises-guide#resolve-promise">resolving
        a Promise</a></dfn> and <dfn data-lt="reject"><a href=
        "http://www.w3.org/2001/tag/doc/promises-guide#reject-promise">rejecting
        a Promise</a></dfn> are used as explained in [[!PROMGUIDE]].
      </p>
      <p>
        The term <dfn><a href="https://url.spec.whatwg.org/#url">URL</a></dfn>
        is defined in the WHATWG URL standard [[!URL]].
      </p>
      <p>
        The term <a href=
        "http://dev.w3.org/2006/webapi/FileAPI/#blob"><dfn><code>Blob</code></dfn></a>
        is defined in the File API specification [[!FILEAPI]].
      </p>
      <p>
        The header <dfn><a href=
        "https://tools.ietf.org/html/rfc7231#section-5.3.5">Accept-Language</a></dfn>
        is defined in HTTP/1.1 [[!rfc7231]].
      </p>
      <p>
        <dfn><a href="https://tools.ietf.org/html/rfc7235#section-2">HTTP
        authentication</a></dfn> is defined in HTTP/1.1: Authentication
        [[!rfc7235]].
      </p>
      <p>
        The term <a href=
        "http://w3c.github.io/webrtc-pc/#idl-def-RTCDataChannel"><dfn><code>RTCDataChannel</code></dfn></a>
        is defined in the WebRTC API specification [[WEBRTC]].
      </p>
      <p>
        The term <dfn><a href=
        "http://tools.ietf.org/html/rfc6265#section-4.2">cookie store</a></dfn>
        is defined in RFC 6265 [[!COOKIES]].
      </p>
      <p>
        The term <dfn><a href=
        "https://tools.ietf.org/html/rfc4122">UUID</a></dfn> is defined in RFC
        4122 [[!rfc4122]].
      </p>
      <p>
        The terms <dfn data-lt="permission|permissions"><a href=
        "https://w3c.github.io/permissions/#idl-def-Permission">permission</a></dfn>
        and <dfn><a href=
        "https://w3c.github.io/permissions/#idl-def-PermissionState">permission
        state</a></dfn> are defined in [[!PERMISSIONS]].
      </p>
      <p>
        The term <dfn data-lt="database|databases"><a href=
        "http://www.w3.org/TR/IndexedDB/#database-concept">database</a></dfn>
        is defined in [[!INDEXEDDB]].
      </p>
      <p>
        The terms <dfn><a href=
        "http://www.w3.org/TR/webstorage/#the-localstorage-attribute">local
        storage areas</a></dfn> and <dfn><a href=
        "http://www.w3.org/TR/webstorage/#the-sessionstorage-attribute">session
        storage areas</a></dfn> are defined in [[!WEBSTORAGE]].
      </p>
      <p>
        The terms <dfn><a href=
        "https://w3c.github.io/webappsec-mixed-content/#a-priori-authenticated-url">
        a priori unauthenticated URL</a></dfn>, and <dfn><a href=
        "https://w3c.github.io/webappsec-mixed-content/#categorize-settings-object">
        prohibits mixed security contexts algorithm</a></dfn> are defined in
        [[!MIXED-CONTENT]].
      </p>
      <p>
        The term <dfn><a href=
        "https://www.w3.org/TR/secure-contexts/#potentially-trustworthy-origin">
        potentially trustworthy origin</a></dfn> is defined in
        [[!SECURE-CONTEXTS]].
      </p>
      <p>
        The terms <dfn data-lt="service worker|service workers"><a href=
        "https://www.w3.org/TR/service-workers-1/#dfn-service-worker">service
        worker</a></dfn>, <dfn data-lt=
        "a list of registered service worker registrations|list of registered service worker registrations">
        <a href=
        "https://www.w3.org/TR/service-workers-1/#service-worker-registration-lifetime">
        a list of registered service worker registrations</a></dfn>,
        <dfn><a href=
        "https://www.w3.org/TR/service-workers-1/#cache-objects">caches</a></dfn>,
        <dfn data-lt="window client|window clients"><a href=
        "https://www.w3.org/TR/service-workers-1/#dfn-window-client">window
        client</a></dfn> and <dfn data-lt=
        "worker client|worker clients"><a href=
        "https://www.w3.org/TR/service-workers-1/#dfn-worker-client">worker
        client</a></dfn> are defined in [[!SERVICE-WORKERS]].
      </p>
      <p>
        The term <dfn><a href="http://www.dial-multiscreen.org/">DIAL</a></dfn>
        is defined in [[DIAL]].
      </p>
    </section>
    <section class="informative">
      <h2>
        Examples
      </h2>
      <p>
        This section shows example codes that highlight the usage of main
        features of the Presentation API. In these examples,
        <code>controller.html</code> implements the controller and
        <code>presentation.html</code> implements the presentation. Both pages
        are served from the domain <code>http://example.org</code>
        (<code>http://example.org/controller.html</code> and
        <code>http://example.org/presentation.html</code>). These examples
        assume that the controlling page is managing one presentation at a
        time. Please refer to the comments in the code examples for further
        details.
      </p>
      <section>
        <h3>
          Monitor availability of presentation displays example
        </h3>
        <pre class="example highlight">
&lt;!-- controller.html --&gt;
&lt;button id="presentBtn" style="display: none;"&gt;Present&lt;/button&gt;
&lt;script&gt;
  // The Present button is visible if at least one presentation display is available
  var presentBtn = document.getElementById("presentBtn");
  // It is also possible to use relative presentation URL e.g. "presentation.html"
  var presUrls = ["http://example.com/presentation.html",
                  "http://example.net/alternate.html"];
  // show or hide present button depending on display availability
  var handleAvailabilityChange = function(available) {
    presentBtn.style.display = available ? "inline" : "none";
  };
  // Promise is resolved as soon as the presentation display availability is
  // known.
  var request = new PresentationRequest(presUrls);
  request.getAvailability().then(function(availability) {
    // availability.value may be kept up-to-date by the controlling UA as long
    // as the availability object is alive. It is advised for the web developers
    // to discard the object as soon as it's not needed.
    handleAvailabilityChange(availability.value);
    availability.onchange = function() { handleAvailabilityChange(this.value); };
  }).catch(function() {
    // Availability monitoring is not supported by the platform, so discovery of
    // presentation displays will happen only after request.start() is called.
    // Pretend the devices are available for simplicity; or, one could implement
    // a third state for the button.
    handleAvailabilityChange(true);
  });
&lt;/script&gt;
</pre>
      </section>
      <section>
        <h3>
          Starting a new presentation example
        </h3>
        <pre class="example highlight">
&lt;!-- controller.html --&gt;
&lt;script&gt;
  presentBtn.onclick = function () {
    // Start new presentation.
    request.start()
      // The connection to the presentation will be passed to setConnection on
      // success.
      .then(setConnection);
      // Otherwise, the user canceled the selection dialog or no screens were
      // found.
  };
&lt;/script&gt;
</pre>
      </section>
      <section>
        <h3>
          Reconnect to a presentation example
        </h3>
        <pre class="example highlight">
&lt;!-- controller.html --&gt;
&lt;button id="reconnectBtn" style="display: none;"&gt;Reconnect&lt;/button&gt;
&lt;script&gt;
  var reconnect = function () {
    // read presId from localStorage if exists
    var presId = localStorage["presId"];
    // presId is mandatory when reconnecting to a presentation.
    if (!!presId) {
      request.reconnect(presId)
        // The new connection to the presentation will be passed to
        // setConnection on success.
        .then(setConnection);
        // No connection found for presUrl and presId, or an error occurred.
    }
  };
  // On navigation of the controller, reconnect automatically.
  document.addEventListener("DOMContentLoaded", reconnect);
  // Or allow manual reconnection.
  const reconnectBtn = document.querySelector("#reconnectBtn");
  reconnectBtn.onclick = reconnect;
&lt;/script&gt;
</pre>
      </section>
      <section>
        <h3>
          Presentation initiation by the controlling UA example
        </h3>
        <pre class="example highlight">
&lt;!-- controller.html --&gt;
&lt;!-- Setting presentation.defaultRequest allows the page to specify the
     PresentationRequest to use when the controlling UA initiates a
     presentation. --&gt;
&lt;script&gt;
  navigator.presentation.defaultRequest = new PresentationRequest(presUrls);
  navigator.presentation.defaultRequest.onconnectionavailable = function(evt) {
    setConnection(evt.connection);
  };
&lt;/script&gt;

</pre>
      </section>
      <section>
        <h3>
          Monitor connection's state and exchange data example
        </h3>
        <pre class="example highlight">
&lt;!-- controller.html --&gt;
&lt;button id="disconnectBtn" style="display: none;"&gt;Disconnect&lt;/button&gt;
&lt;button id="stopBtn" style="display: none;"&gt;Stop&lt;/button&gt;
&lt;script&gt;
  let connection;

  // The Disconnect and Stop buttons are visible if there is a connected presentation
  const stopBtn = document.querySelector("#stopBtn");
  const disconnectBtn = document.querySelector("#disconnectBtn");

  stopBtn.onclick = _ =&gt; {
    connection &amp;&amp; connection.terminate();
  };

  disconnectBtn.onclick = _ =&gt; {
    connection &amp;&amp; connection.close();
  };

  function setConnection(newConnection) {
    // Disconnect from existing presentation, if not attempting to reconnect
    if (connection &amp;&amp; connection != newConnection &amp;&amp; connection.state != 'closed') {
      connection.onclosed = undefined;
      connection.close();
    }

    // Set the new connection and save the presentation ID
    connection = newConnection;
    localStorage["presId"] = connection.id;

    function showConnectedUI() {
      // Allow the user to disconnect from or terminate the presentation
      stopBtn.style.display = "inline";
      disconnectBtn.style.display = "inline";
      reconnectBtn.style.display = "none";
    }

    function showDisconnectedUI() {
      disconnectBtn.style.display = "none";
      stopBtn.style.display = "none";
      reconnectBtn.style.display = localStorage["presId"] ? "inline" : "none";
    }

    // Monitor the connection state
    connection.onconnect = _ =&gt; {
      showConnectedUI();

      // Register message handler
      connection.onmessage = message =&gt; {
        console.log(`Received message: ${message.data}`);
      };

      // Send initial message to presentation page
      connection.send("Say hello");
    };

    connection.onclose = _ =&gt; {
      connection = null;
      showDisconnectedUI();
    };

    connection.onterminate = _ =&gt; {
      // Remove presId from localStorage if exists
      delete localStorage["presId"];
      connection = null;
      showDisconnectedUI();
    };
  };
&lt;/script&gt;
</pre>
      </section>
      <section>
        <h3>
          Monitor available connection(s) and say hello
        </h3>
        <pre class="example highlight">
&lt;!-- presentation.html --&gt;
&lt;script&gt;
  var addConnection = function(connection) {
    this.onmessage = function (message) {
      if (message.data == "say hello")
        this.send("hello");
    };
  };

  navigator.presentation.receiver.connectionList.then(function (list) {
    list.connections.map(function (connection) {
      addConnection(connection);
    });
    list.onconnectionavailable = function (evt) {
      addConnection(evt.connection);
    };
  });
&lt;/script&gt;
</pre>
      </section>
      <section>
        <h3>
          Passing locale information with a message
        </h3>
        <pre class="example highlight">
&lt;!-- controller.html --&gt;
&lt;script&gt;
  connection.send("{string: 'ä½ å¥½ï¼ä¸ç!', lang: 'zh-CN'}");
  connection.send("{string: 'ããã«ã¡ã¯ãä¸ç!', lang: 'ja'}");
  connection.send("{string: 'ìëíì¸ì, ì¸ê³!', lang: 'ko'}");
  connection.send("{string: 'Hello, world!', lang: 'en-US'}");
&lt;/script&gt;

&lt;!-- presentation.html --&gt;
&lt;script&gt;
  connection.onmessage = function (message) {
    var messageObj = JSON.parse(message.data);
    var spanElt = document.createElement("SPAN");
    spanElt.lang = messageObj.lang;
    spanElt.textContent = messageObj.string;
    document.appendChild(spanElt);
  };
&lt;/script&gt;
</pre>
      </section>
    </section>
    <section>
      <h2>
        API
      </h2>
      <section>
        <h3>
          Common idioms
        </h3>
        <p>
          A <dfn lt="presentation display|presentation displays">presentation
          display</dfn> refers to an external screen available to the user
          agent via an implementation specific connection technology.
        </p>
        <p>
          A <dfn lt=
          "presentation connection|presentation connections">presentation
          connection</dfn> is an object relating a <a>controlling browsing
          context</a> to its <a>receiving browsing context</a> and enables
          two-way-messaging between them. Each <a>presentation connection</a>
          has a <dfn>presentation connection state</dfn>, a unique <dfn lt=
          "presentation identifier|presentation identifiers">presentation
          identifier</dfn> to distinguish it from other <a>presentations</a>,
          and a <dfn>presentation URL</dfn> that is a <a>URL</a> used to create
          or reconnect to the <a href=
          "#dfn-receiving-browsing-context">presentation</a>. A <dfn>valid
          presentation identifier</dfn> consists of alphanumeric ASCII
          characters only and is at least 16 characters long.
        </p>
        <p>
          Some <a>presentation displays</a> may only be able to display a
          subset of Web content because of functional, security or hardware
          limitations. Examples are set-top boxes, smart TVs or networked
          speakers capable of rendering only audio. We say that such a display
          is an <dfn lt=
          "available presentation display|available presentation displays">available
          presentation display</dfn> for a URL if the <a>controlling user
          agent</a> can reasonably guarantee that the presentation of the URL
          on that display will succeed.
        </p>
        <p>
          A <dfn lt=
          "controlling browsing context|controlling browsing contexts|controller">
          controlling browsing context</dfn> (or <strong>controller</strong>
          for short) is a <a>browsing context</a> that has connected to a
          <a href="#dfn-receiving-browsing-context">presentation</a> by calling
          <a for="PresentationRequest">start</a> or <a for=
          "PresentationRequest">reconnect</a>, or received a <a>presentation
          connection</a> via a <a for=
          "PresentationRequest">connectionavailable</a> event. In algorithms
          for <a><code>PresentationRequest</code></a>, the <a>controlling
          browsing context</a> is the <a>responsible browsing context</a> whose
          <a>JavaScript realm</a> was used to construct the
          <a><code>PresentationRequest</code></a>.
        </p>
        <p>
          The <dfn data-lt=
          "receiving browsing context|receiving browsing contexts|presentations">
          receiving browsing context</dfn> (or <strong>presentation</strong>
          for short) is the browsing context responsible for rendering to a
          <a>presentation display</a>. A <a>receiving browsing context</a> can
          reside in the same user agent as the <a>controlling browsing
          context</a> or a different one. A <a>receiving browsing context</a>
          is created by following the steps to <a>create a receiving browsing
          context</a>.
        </p>
        <p>
          In a procedure, the <dfn>destination browsing context</dfn> is the
          <a>receiving browsing context</a> when the procedure is initiated at
          the <a>controlling browsing context</a>, or the <a>controlling
          browsing context</a> if it is initiated at the <a>receiving browsing
          context</a>.
        </p>
        <p>
          The <dfn>set of controlled presentations</dfn>, initially empty,
          contains the <a>presentation connections</a> created by the
          <a>controlling browsing contexts</a> for the <a>controlling user
          agent</a> (or a specific user profile within that user agent). The
          <a>set of controlled presentations</a> is represented by a list of
          <a>PresentationConnection</a> objects that represent the underlying
          <a>presentation connections</a>. Several
          <a>PresentationConnection</a> objects may share the same
          <a>presentation URL</a> and <a>presentation identifier</a> in that
          set, but there can be only one <a>PresentationConnection</a> with a
          specific <a>presentation URL</a> and <a>presentation identifier</a>
          for a given <a>controlling browsing context</a>.
        </p>
        <p>
          The <dfn>set of presentation controllers</dfn>, initially empty,
          contains the <a>presentation connections</a> created by a
          <a>receiving browsing context</a> for the <a>receiving user
          agent</a>. The <a>set of presentation controllers</a> is represented
          by a list of <a>PresentationConnection</a> objects that represent the
          underlying <a>presentation connections</a>. All <a>presentation
          connections</a> in this set share the same <a>presentation URL</a>
          and <a>presentation identifier</a>.
        </p>
        <p>
          In a <a>receiving browsing context</a>, the <dfn>presentation
          controllers monitor</dfn>, initially set to <code>null</code>,
          exposes the current <a>set of presentation controllers</a> to the
          receiving application. The <a>presentation controllers monitor</a> is
          represented by a <a>PresentationConnectionList</a>.
        </p>
        <p>
          In a <a>receiving browsing context</a>, the <dfn>presentation
          controllers promise</dfn>, which is initially set to
          <code>null</code>, provides the <a>presentation controllers
          monitor</a> once the initial <a>presentation connection</a> is
          established. The <a>presentation controllers promise</a> is
          represented by a <a>Promise</a> that resolves with the
          <a>presentation controllers monitor</a>.
        </p>
        <p>
          In a <a>controlling browsing context</a>, the <dfn>default
          presentation request</dfn>, which is initially set to
          <code>null</code>, represents the request to use when the user wishes
          to initiate a <a>presentation connection</a> from the browser chrome.
        </p>
        <p>
          The <a>task source</a> for the tasks mentioned in this specification
          is the <dfn>presentation task source</dfn>.
        </p>
        <p>
          Unless otherwise specified, the <a>JavaScript realm</a> for script
          objects constructed by algorithm steps is the <a>current realm</a>.
        </p>
      </section>
      <section>
        <h3>
          Interface <dfn>Presentation</dfn>
        </h3>
        <pre class="idl">
          partial interface Navigator {
            [SameObject] readonly attribute Presentation presentation;
          };
          
          interface Presentation {
          };
        
</pre>
        <p>
          The <dfn for="Navigator"><code>presentation</code></dfn> attribute is
          used to retrieve an instance of the <a><code>Presentation</code></a>
          interface. It MUST return the <a><code>Presentation</code></a>
          instance.
        </p>
        <section>
          <h4>
            Controlling user agent
          </h4>
          <p>
            <a data-lt="controlling user agent">Controlling user agents</a>
            MUST implement the following partial interface:
          </p>
          <pre class="idl idl-controlling-ua">
            partial interface Presentation {
              attribute PresentationRequest? defaultRequest;
            };
          
</pre>
          <p>
            The <dfn for="Presentation"><code>defaultRequest</code></dfn>
            attribute MUST return the <a>default presentation request</a> if
            any, <code>null</code> otherwise. On setting, the <a>default
            presentation request</a> MUST be set to the new value.
          </p>
          <p>
            The <a>controlling user agent</a> SHOULD initiate presentation
            using the <a>default presentation request</a> only when the user
            has expressed an intention to do so via a user gesture, for example
            by clicking a button in the browser chrome.
          </p>
          <p>
            To initiate presentation using the <a>default presentation
            request</a>, the <a>controlling user agent</a> MUST follow the
            steps to <a>start a presentation from a default presentation
            request</a>.
          </p>
          <p>
            Support for initiating a presentation using the <a>default
            presentation request</a> is OPTIONAL.
          </p>
          <div class="note">
            If a <a>controlling user agent</a> does not support <a>starting a
            presentation from a default presentation request</a>, that user
            agent should ignore any value set for <a for=
            "Presentation">defaultRequest</a>.
          </div>
        </section>
        <section>
          <h4>
            Receiving user agent
          </h4>
          <p>
            <a data-lt="Receiving user agent">Receiving user agents</a> MUST
            implement the following partial interface:
          </p>
          <pre class="idl idl-receiving-ua">
            partial interface Presentation {
              readonly attribute PresentationReceiver? receiver;
            };
          
</pre>
          <p>
            The <dfn for="Presentation"><code>receiver</code></dfn> attribute
            MUST return the <a><code>PresentationReceiver</code></a> instance
            associated with the <a>receiving browsing context</a> and created
            by the <a>receiving user agent</a> when the <a>receiving browsing
            context</a> is <a data-lt=
            "create a receiving browsing context">created</a>. In any other
            <a>browsing context</a> (including <a data-lt=
            "nested browsing context">nested browsing contexts</a> of the
            <a>receiving browsing context</a>) it MUST return
            <code>null</code>.
          </p>
          <p class="note">
            Web developers can use <a data-lt=
            "Presentation.receiver">navigator.presentation.receiver</a> to
            detect when a document is loaded as a presentation.
          </p>
        </section>
      </section>
      <section>
        <h3>
          Interface <dfn>PresentationRequest</dfn>
        </h3>
        <pre class="idl">
          [Constructor(USVString url),
           Constructor(sequence&lt;USVString&gt; urls)]
          interface PresentationRequest : EventTarget {
            Promise&lt;PresentationConnection&gt; start();
            Promise&lt;PresentationConnection&gt; reconnect(USVString presentationId);
            Promise&lt;PresentationAvailability&gt; getAvailability();

            attribute EventHandler onconnectionavailable;
          };


</pre>
        <p>
          A <a><code>PresentationRequest</code></a> object is associated with a
          request to initiate or reconnect to a presentation made by a
          <a>controlling browsing context</a>. The
          <a><code>PresentationRequest</code></a> object MUST be implemented in
          a <a>controlling browsing context</a> provided by a <a>controlling
          user agent</a>.
        </p>
        <p>
          When a <a><code>PresentationRequest</code></a> is constructed, the
          given <code>urls</code> MUST be used as the list of <dfn data-lt=
          "presentation request URL">presentation request URLs</dfn> which are
          each a possible <a>presentation URL</a> for the
          <a><code>PresentationRequest</code></a> instance.
        </p>
        <section>
          <h4>
            Constructing a <a>PresentationRequest</a>
          </h4>
          <p>
            When the <a>PresentationRequest</a> constructor is called, the
            <a>controlling user agent</a> MUST run these steps:
          </p>
          <dl>
            <dt>
              Input
            </dt>
            <dd>
              <var>url</var> or <var>urls</var>, the <a>presentation request
              URLs</a>
            </dd>
            <dt>
              Output
            </dt>
            <dd>
              A <a>PresentationRequest</a> object
            </dd>
          </dl>
          <ol>
            <li>If the document object's <a>active sandboxing flag set</a> has
            the <a>sandboxed presentation browsing context flag</a> set, then
            throw a <a>SecurityError</a> and abort these steps.
            </li>
            <li>If <var>urls</var> is an empty sequence, then <a>throw</a> a
            <a>NotSupportedError</a> and abort all remaining steps.
            </li>
            <li>If a single <var>url</var> was provided, let <var>urls</var> be
            a one item array containing <var>url</var>.
            </li>
            <li>Let <var>presentationUrls</var> be an empty list of URLs.
            </li>
            <li>For each URL <var>U</var> in <var>urls</var>:
              <ol>
                <li>Resolve <var>U</var> relative to the API base URL specified
                by the <a>current settings object</a>, and add the resulting
                absolute URL (if any) to <var>presentationUrls</var>.
                </li>
                <li>If the resolve a URL algorithm failed, then <a>throw</a> a
                <a>SyntaxError</a> exception and abort all remaining steps.
                </li>
              </ol>
            </li>
            <li>Using the document's <a>relevant settings object</a>, run the
            <a>prohibits mixed security contexts algorithm</a>.
            </li>
            <li>If the result of the algorithm is <code>"Prohibits Mixed
            Security Contexts"</code> and any member of
            <var>presentationUrls</var> is an <a>a priori unauthenticated
            URL</a>, then throw a <a>SecurityError</a> and abort these steps.
            </li>
            <li>Construct a new <a>PresentationRequest</a> object with
            <var>presentationUrls</var> as its <a>presentation request URLs</a>
            and return it.
            </li>
          </ol>
        </section>
        <section>
          <h4>
            Selecting a presentation display
          </h4>
          <p>
            When the <code><dfn for="PresentationRequest">start</dfn></code>
            method is called, the <a>user agent</a> MUST run the following
            steps to <dfn>select a presentation display</dfn>.
          </p>
          <dl>
            <dt>
              Input
            </dt>
            <dd>
              <var>presentationRequest</var>, the <a>PresentationRequest</a>
              object that received the call to <a for=
              "PresentationRequest">start</a>
            </dd>
            <dt>
              Output
            </dt>
            <dd>
              A <a>Promise</a>
            </dd>
          </dl>
          <ol>
            <li>If the algorithm isn't <a>allowed to show a popup</a>, return a
            <a>Promise</a> rejected with an <a>InvalidAccessError</a> exception
            and abort these steps.
            </li>
            <li>Let <var>topContext</var> be the <a>top-level browsing
            context</a> of the <a>controlling browsing context</a>.
            </li>
            <li>If there is already an unsettled <a>Promise</a> from a previous
            call to <a for="PresentationRequest">start</a> in
            <var>topContext</var> or any <a>browsing context</a> in the <a>list
            of descendant browsing contexts</a> of <var>topContext</var>,
            return a new <a>Promise</a> rejected with an <a>OperationError</a>
            exception and abort all remaining steps.
            </li>
            <li>Let <var>P</var> be a new <a>Promise</a>.
            </li>
            <li>Return <var>P</var>, but continue running these steps <a>in
            parallel</a>.
            </li>
            <li>If the <a>user agent</a> is not <a data-lt=
            "monitor the list of available presentation displays">monitoring
            the list of available presentation displays</a>, run the steps to
            <a>monitor the list of available presentation displays</a> <a>in
            parallel</a>.
            </li>
            <li>Let <var>presentationUrls</var> be the <a>presentation request
            URLs</a> of <var>presentationRequest</var>.
            </li>
            <li>Request user permission for the use of a <a>presentation
            display</a> and selection of one presentation display.
            </li>
            <li>If either of the following is true:
              <ol>
                <li>The <a>list of available presentation displays</a> is empty
                and will remain so before the request for user permission is
                completed.
                </li>
                <li>No member in the <a>list of available presentation
                displays</a> is an <a>available presentation display</a> for
                any member of <var>presentationUrls</var>.
                </li>
              </ol>Then run the following steps:
              <ol>
                <li>
                  <a>Reject</a> <var>P</var> with a <a>NotFoundError</a>
                  exception.
                </li>
                <li>Abort all remaining steps.
                </li>
              </ol>
            </li>
            <li>If the user <em>denies permission</em> to use a display, reject
            <var>P</var> with an <a>NotAllowedError</a> exception, and abort
            all remaining steps.
            </li>
            <li>Otherwise, the user <em>grants permission</em> to use a
            display; let <var>D</var> be that display.
            </li>
            <li>Run the steps to <a>start a presentation connection</a> with
            <var>presentationRequest</var>, <var>D</var>, and <var>P</var>.
            </li>
          </ol>
          <div class="note">
            The details of implementing the permission request and display
            selection are left to the user agent; for example it may show the
            user a dialog and allow the user to select an available display
            (granting permission), or cancel the selection (denying
            permission). Implementers are encouraged to show the user whether
            an available display is currently in use, to facilitate
            presentations that can make use of multiple displays.
          </div>
          <div class="note">
            Receiving user agents are encouraged to advertise a user friendly
            name for the presentation display, e.g. &quot;Living Room TV&quot;,
            to assist the user in selecting the intended display. Implementers
            of receiving user agents are also encouraged to advertise the
            locale and intended text direction of the user friendly name.
            Implementers of controlling user agents are encouraged to render a
            user friendly name using its locale and text direction when they
            are known.
          </div>
        </section>
        <section>
          <h4>
            Starting a presentation from a default presentation request
          </h4>
          <p>
            When the user expresses an intent to start presentation of a
            document on a presentation display using the browser chrome (via a
            dedicated button, user gesture, or other signal), that user agent
            MUST run the following steps to <dfn data-lt=
            "starting a presentation from a default presentation request">start
            a presentation from a default presentation request</dfn>. If no
            <a>default presentation request</a> is set on the document, these
            steps MUST not be run.
          </p>
          <dl>
            <dt>
              Input
            </dt>
            <dd>
              <var>W</var>, the document on which the user has expressed an
              intent to start presentation
            </dd>
            <dd>
              <var>presentationRequest</var>, the non-<code>null</code> value
              of <a data-lt=
              "Presentation.defaultRequest">navigator.presentation.defaultRequest</a>
              set on <var>W</var>
            </dd>
            <dd>
              <var>D</var>, the <a>presentation display</a> that is the target
              for presentation
            </dd>
          </dl>
          <ol>
            <li>Let <var>presentationUrls</var> be the <a>presentation request
            URLs</a> of <var>presentationRequest</var>.
            </li>
            <li>If there is no <a>presentation request URL</a> for
            <var>presentationRequest</var> for which <var>D</var> is an
            <a>available presentation display</a>, then abort these steps.
            </li>
            <li>Run the steps to <a>start a presentation connection</a> with
            <var>presentationRequest</var> and <var>D</var>.
            </li>
          </ol>
          <div class="note">
            When <a>starting a presentation from a default presentation
            request</a>, a <a>controlling user agent</a> may allow the user to
            request presentation and choose the intended <a>presentation
            display</a> with the same user gesture. For example, the browser
            chrome could allow the user to pick a display from a menu, or allow
            the user to tap on an <a href="https://nfc-forum.org/">Near Field
            Communications (NFC)</a> enabled display.
          </div>
        </section>
        <section>
          <h4>
            Starting a presentation connection
          </h4>
          <p>
            When the <a>user agent</a> is to <dfn>start a presentation
            connection</dfn>, it MUST run the following steps:
          </p>
          <dl>
            <dt>
              Input
            </dt>
            <dd>
              <var>presentationRequest</var>, the <a>PresentationRequest</a>
              that is used to start the presentation connection
            </dd>
            <dd>
              <var>D</var>, the selected <a>presentation display</a>
            </dd>
            <dd>
              <var>P</var>, an optional <a>Promise</a> that will be resolved
              with a new <a>presentation connection</a>
            </dd>
          </dl>
          <ol>
            <li>Let <var>I</var> be a new <a>valid presentation identifier</a>
            unique among all <a>presentation identifiers</a> for known
            <a>presentation connections</a> in the <a>set of controlled
            presentations</a>. To avoid fingerprinting, implementations SHOULD
            set the <a>presentation identifier</a> to a <a>UUID</a> generated
            by following forms 4.4 or 4.5 of [[rfc4122]].
            </li>
            <li>Create a new <a>PresentationConnection</a> <var>S</var>.
            </li>
            <li>Set the <a>presentation identifier</a> of <var>S</var> to <var>
              I</var>.
            </li>
            <li>Let <var>presentationUrls</var> be the <a>presentation request
            URLs</a> of <var>presentationRequest</var>.
            </li>
            <li>Set the <a>presentation URL</a> for <var>S</var> to the first
            <var>presentationUrl</var> in <var>presentationUrls</var> for which
            there exists an entry <var>(presentationUrl, D)</var> in the
            <a>list of available presentation displays</a>.
            </li>
            <li>Set the <a>presentation connection state</a> of <var>S</var> to
            <a for="PresentationConnectionState">connecting</a>.
            </li>
            <li>Add <var>S</var> to the <a>set of controlled presentations</a>.
            </li>
            <li>If <var>P</var> is provided, <a>resolve</a> <var>P</var> with
            <var>S</var>.
            </li>
            <li>
              <a>Queue a task</a> to <a>fire</a> a <a>trusted event</a> with
              the name <a for="PresentationRequest">connectionavailable</a>,
              that uses the <a>PresentationConnectionAvailableEvent</a>
              interface, with the <a for=
              "PresentationConnectionAvailableEvent">connection</a> attribute
              initialized to <var>S</var>, at <var>presentationRequest</var>.
              The event must not bubble, must not be cancelable, and has no
              default action.
            </li>
            <li>Let <var>U</var> be the user agent connected to D.
            </li>
            <li>If the next step fails, abort all remaining steps and <a>close
            the presentation connection</a> <var>S</var> with <a for=
            "PresentationConnectionCloseReason">error</a> as
            <var>closeReason</var>, and a human readable message describing the
            failure as <var>closeMessage</var>.
            </li>
            <li>Using an implementation specific mechanism, tell <var>U</var>
            to <a>create a receiving browsing context</a> with <var>D</var>,
            <var>presentationUrl</var>, and <var>I</var> as parameters.
            </li>
            <li>
              <a>Establish a presentation connection</a> with <var>S</var>.
            </li>
          </ol>
          <div class="note">
            The <var>presentationUrl</var> should name a resource accessible to
            the local or a remote user agent. This specification defines
            behavior for <var>presentationUrl</var> using the <code>http</code>
            or <code>https</code> schemes; behavior for other schemes is not
            defined by this specification.
          </div>
        </section>
        <section>
          <h4>
            Reconnecting to a presentation
          </h4>
          <p>
            When the <dfn for="PresentationRequest">reconnect</dfn> method is
            called, the <a>user agent</a> MUST run the following steps to
            <dfn>reconnect to a presentation</dfn>:
          </p>
          <dl>
            <dt>
              Input
            </dt>
            <dd>
              <var>presentationRequest</var>, the <a>PresentationRequest</a>
              object that <a for="PresentationRequest">reconnect</a> was called
              on
            </dd>
            <dd>
              <var>presentationId</var>, a valid <a>presentation identifier</a>
            </dd>
            <dt>
              Output
            </dt>
            <dd>
              <var>P</var>, a <a>Promise</a>
            </dd>
          </dl>
          <ol>
            <li>Let <var>P</var> be a new <a>Promise</a>.
            </li>
            <li>Return <var>P</var>, but continue running these steps in
            parallel.
            </li>
            <li>Search the <a>set of controlled presentations</a> for a
            <a>PresentationConnection</a> that meets the following criteria:
              <ul>
                <li>Its <a>controlling browsing context</a> is the current <a>
                  browsing context</a>
                </li>
                <li>Its <a>presentation connection state</a> is not <a for=
                "PresentationConnectionState">terminated</a>
                </li>
                <li>Its <a>presentation URL</a> is equal to one of the
                <a>presentation request URLs</a> of
                <var>presentationRequest</var>
                </li>
                <li>Its <a>presentation identifier</a> is equal to
                <var>presentationId</var>
                </li>
              </ul>
            </li>
            <li>If such a <a>PresentationConnection</a> exists, run the
            following steps:
              <ol>
                <li>Let <var>existingConnection</var> be that
                <a>PresentationConnection</a>.
                </li>
                <li>
                  <a>Resolve</a> <var>P</var> with
                  <var>existingConnection</var>.
                </li>
                <li>If the <a>presentation connection state</a> of
                <var>existingConnection</var> is <a for=
                "PresentationConnectionState">connecting</a> or <a for=
                "PresentationConnectionState">connected</a>, then abort all
                remaining steps.
                </li>
                <li>Set the <a>presentation connection state</a> of
                <var>existingConnection</var> to <a for=
                "PresentationConnectionState">connecting</a>.
                </li>
                <li>
                  <a>Establish a presentation connection</a> with
                  <var>existingConnection</var>.
                </li>
                <li>Abort all remaining steps.
                </li>
              </ol>
            </li>
            <li>Search the <a>set of controlled presentations</a> for the first
            <a>PresentationConnection</a> that meets the following criteria:
              <ul>
                <li>Its <a>controlling browsing context</a> is not the current
                <a>browsing context</a>
                </li>
                <li>Its <a>presentation connection state</a> is not <a for=
                "PresentationConnectionState">terminated</a>
                </li>
                <li>Its <a>presentation URL</a> is equal to one of the
                <a>presentation request URLs</a> of
                <var>presentationRequest</var>
                </li>
                <li>Its <a>presentation identifier</a> is equal to
                <var>presentationId</var>
                </li>
              </ul>
            </li>
            <li>If such a <a>PresentationConnection</a> exists, run the
            following steps:
              <ol>
                <li>Let <var>existingConnection</var> be that
                <a>PresentationConnection</a>.
                </li>
                <li>Create a new <a>PresentationConnection</a>
                <var>newConnection</var>.
                </li>
                <li>Set the <a>presentation identifier</a> of
                <var>newConnection</var> to <var>presentationId</var>.
                </li>
                <li>Set the <a>presentation URL</a> of <var>newConnection</var>
                to the <a>presentation URL</a> of
                <var>existingConnection</var>.
                </li>
                <li>Set the <a>presentation connection state</a> of
                <var>newConnection</var> to <a for=
                "PresentationConnectionState">connecting</a>.
                </li>
                <li>Add <var>newConnection</var> to the <a>set of controlled
                presentations</a>.
                </li>
                <li>
                  <a>Resolve</a> <var>P</var> with <var>newConnection</var>.
                </li>
                <li>
                  <a>Queue a task</a> to <a>fire</a> a <a>trusted event</a>
                  with the name <a for=
                  "PresentationRequest">connectionavailable</a>, that uses the
                  <a>PresentationConnectionAvailableEvent</a> interface, with
                  the <a for=
                  "PresentationConnectionAvailableEvent">connection</a>
                  attribute initialized to <var>newConnection</var>, at
                  <var>presentationRequest</var>. The event must not bubble,
                  must not be cancelable, and has no default action.
                </li>
                <li>
                  <a>Establish a presentation connection</a> with
                  <var>newConnection</var>.
                </li>
                <li>Abort all remaining steps.
                </li>
              </ol>
            </li>
            <li>
              <a>Reject</a> <var>P</var> with a <a>NotFoundError</a> exception.
            </li>
          </ol>
        </section>
        <section>
          <h4>
            Event Handlers
          </h4>
          <p>
            The following are the event handlers (and their corresponding event
            handler event types) that must be supported, as event handler IDL
            attributes, by objects implementing the <a>PresentationRequest</a>
            interface:
          </p>
          <table dfn-for="PresentationRequest">
            <thead>
              <tr>
                <th>
                  Event handler
                </th>
                <th>
                  Event handler event type
                </th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td>
                  <dfn><code>onconnectionavailable</code></dfn>
                </td>
                <td>
                  <dfn><code>connectionavailable</code></dfn>
                </td>
              </tr>
            </tbody>
          </table>
        </section>
      </section>
      <section>
        <h3>
          Interface <dfn>PresentationAvailability</dfn>
        </h3>
        <pre class="idl">
          interface PresentationAvailability : EventTarget {
            readonly attribute boolean value;

            attribute EventHandler onchange;
          };

</pre>
        <p>
          A <a><code>PresentationAvailability</code></a> object exposes the
          <a>presentation display availability</a> for a presentation request.
          The <dfn>presentation display availability</dfn> for a
          <a>PresentationRequest</a> stores whether there is currently any
          <a>available presentation display</a> for at least one of the
          <a>presentation request URLs</a> of the request.
        </p>
        <p>
          The <a>presentation display availability</a> for a presentation
          request is eligible for garbage collection when no ECMASCript code
          can observe the <a>PresentationAvailability</a> object.
        </p>
        <p>
          If the <a>controlling user agent</a> can <a>monitor the list of
          available presentation displays</a> in the background (without a
          pending request to <a for="PresentationRequest">start</a>), the
          <a><code>PresentationAvailability</code></a> object MUST be
          implemented in a <a>controlling browsing context</a>.
        </p>
        <p>
          The <dfn for="PresentationAvailability">value</dfn> attribute MUST
          return the last value it was set to. The value is initialized and
          updated by the <a>monitor the list of available presentation
          displays</a> algorithm.
        </p>
        <p>
          The <dfn for="PresentationAvailability">onchange</dfn> attribute is
          an <a>event handler</a> whose corresponding <a>event handler event
          type</a> is <dfn><code>change</code></dfn>.
        </p>
        <section>
          <h4>
            The set of presentation availability objects
          </h4>
          <p>
            The <a>user agent</a> MUST keep track of the <dfn>set of
            presentation availability objects</dfn> created by the <a for=
            "PresentationRequest">getAvailability</a> method. The <a>set of
            presentation availability objects</a> is represented as a set of
            tuples <em>(<var>A</var>, <var>availabilityUrls</var>)</em>,
            initially empty, where:
          </p>
          <ol>
            <li>
              <var>A</var> is a live <a>PresentationAvailability</a> object.
            </li>
            <li>
              <var>availabilityUrls</var> is the list of <a>presentation
              request URLs</a> for the <a>PresentationRequest</a> when <a for=
              "PresentationRequest">getAvailability</a> was called on it to
              create <var>A</var>.
            </li>
          </ol>
        </section>
        <section>
          <h4>
            The list of available presentation displays
          </h4>
          <p>
            The <a>user agent</a> MUST keep a <dfn>list of available
            presentation displays</dfn>. The <a>list of available presentation
            displays</a> is represented by a list of tuples
            <var>(availabilityUrl, display)</var>. An entry in this list means
            that <var>display</var> is currently an <a>available presentation
            display</a> for <var>availabilityUrl</var>. This list of
            <a>presentation displays</a> may be used for starting new
            presentations, and is populated based on an implementation specific
            discovery mechanism. It is set to the most recent result of the
            algorithm to <a>monitor the list of available presentation
            displays</a>.
          </p>
          <p>
            While the <a>set of presentation availability objects</a> is not
            empty, the <a>user agent</a> MAY <a>monitor the list of available
            presentation displays</a> continuously, so that pages can use the
            <a for="PresentationAvailability">value</a> property of a
            <a>PresentationAvailability</a> object to offer presentation only
            when there are available displays. However, the <a>user agent</a>
            may not support continuous availability monitoring in the
            background; for example, because of platform or power consumption
            restrictions. In this case the <a>Promise</a> returned by <a for=
            "PresentationRequest">getAvailability</a> is <a data-lt=
            "reject">rejected</a>, and the algorithm to <a>monitor the list of
            available presentation displays</a> will only run as part of the
            <a>select a presentation display</a> algorithm.
          </p>
          <p>
            When the <a>set of presentation availability objects</a> is empty
            (that is, there are no <var>availabilityUrls</var> being
            monitored), user agents SHOULD NOT <a>monitor the list of available
            presentation displays</a> to satisfy the <a href=
            "https://github.com/w3c/presentation-api/blob/gh-pages/uc-req.md#nf-req01-power-saving-friendly">
            power saving non-functional requirement</a>. To further save power,
            the <a>user agent</a> MAY also keep track of whether a page holding
            a <a>PresentationAvailability</a> object is in the foreground.
            Using this information, implementation specific discovery of
            <a>presentation displays</a> can be resumed or suspended.
          </p>
        </section>
        <section>
          <h4>
            Getting the <a>presentation displays</a> availability information
          </h4>
          <p>
            When the <dfn for="PresentationRequest">getAvailability</dfn>
            method is called, the user agent MUST run the following steps:
          </p>
          <dl>
            <dt>
              Input
            </dt>
            <dd>
              <var>presentationRequest</var>, the <a>PresentationRequest</a>
              object that received the call to <a for=
              "PresentationRequest">getAvailability</a>
            </dd>
            <dt>
              Output
            </dt>
            <dd>
              A <a>Promise</a>
            </dd>
          </dl>
          <ol>
            <li>If there is an unsettled <a>Promise</a> from a previous call to
            <a for="PresentationRequest">getAvailability</a> on
            <var>presentationRequest</var>, return that <a>Promise</a> and
            abort these steps.
            </li>
            <li>Otherwise, let <var>P</var> be a new <a>Promise</a> constructed
            in the <a>JavaScript realm</a> of <var>presentationRequest</var>.
            </li>
            <li>Return <var>P</var>, but continue running these steps <a>in
            parallel</a>.
            </li>
            <li>If the user agent is unable to continuously <a>monitor the list
            of available presentation displays</a> in the background, but can
            later find presentation displays in order to start a connection,
            then:
              <ol>
                <li>
                  <a>Reject</a> <var>P</var> with a <a>NotSupportedError</a>
                  exception.
                </li>
                <li>Abort all the remaining steps.
                </li>
              </ol>
            </li>
            <li>If the <a>presentation display availability</a> for
            <var>presentationRequest</var> is not <code>null</code>, then:
              <ol>
                <li>
                  <a>Resolve</a> <var>P</var> with the request's
                  <a>presentation display availability</a>.
                </li>
                <li>Abort all the remaining steps.
                </li>
              </ol>
            </li>
            <li>Set the <a>presentation display availability</a> for
            <var>presentationRequest</var> to a newly created
            <a>PresentationAvailability</a> object constructed in the
            <a>JavaScript realm</a> of <var>presentationRequest</var>, and let
            <var>A</var> be that object.
            </li>
            <li>Create a tuple <em>(<var>A</var>,
            <var>presentationUrls</var>)</em> and add it to the <a>set of
            presentation availability objects</a>.
            </li>
            <li>Run the algorithm to <a>monitor the list of available
            presentation displays</a>.
              <div class="note">
                The monitoring algorithm must be run at least one more time
                after the previous step to pick up the tuple that was added to
                the <a>set of presentation availability objects</a>.
              </div>
            </li>
            <li>
              <a>Resolve</a> <var>P</var> with <var>A</var>.
            </li>
          </ol>
        </section>
        <section>
          <h4>
            Monitoring the list of available presentation displays
          </h4>
          <p>
            If the <a>set of presentation availability objects</a> is
            non-empty, or there is a pending request to <a for=
            "PresentationRequest" data-lt="start">select a presentation
            display</a>, the <a>user agent</a> MUST <dfn>monitor the list of
            available presentation displays</dfn> by running the following
            steps:
          </p>
          <ol link-for="PresentationAvailability">
            <li>Let <var>availabilitySet</var> be a shallow copy of the <a>set
            of presentation availability objects</a>.
            </li>
            <li>If there is a pending request to <a for="PresentationRequest"
            data-lt="start">select a presentation display</a> for a
            <a>PresentationRequest</a> and if the <a>PresentationRequest</a>'s
            <a>presentation display availability</a> is <code>null</code>, then
            run the following substeps:
              <ol>
                <li>Let <var>A</var> be a newly created
                <a>PresentationAvailability</a> object.
                </li>
                <li>Create a tuple <em>(<var>A</var>,
                <var>presentationUrls</var>)</em> where
                <var>presentationUrls</var> is the <a>PresentationRequest</a>'s
                <a>presentation request URLs</a> and add it to
                <var>availabilitySet</var>.
                </li>
              </ol>
            </li>
            <li>Let <var>newDisplays</var> be an empty list.
            </li>
            <li>If the <a>user agent</a> is unable to retrieve <a>presentation
            displays</a> (e.g., because the user has disabled this capability),
            then skip the following step.
            </li>
            <li>Retrieve <a>presentation displays</a> (using an implementation
            specific mechanism) and set <var>newDisplays</var> to this list.
            </li>
            <li>Set the <a>list of available presentation displays</a> to the
            empty list.
            </li>
            <li>For each member <em>(<var>A</var>,
            <var>availabilityUrls</var>)</em> of <var>availabilitySet</var>,
            run the following steps:
              <ol>
                <li>Set <var>previousAvailability</var> to the value of
                <var>A</var>'s <a>value</a> property.
                </li>
                <li>Let <var>newAvailability</var> be <code>false</code>.
                </li>
                <li>For each <var>availabilityUrl</var> in
                <var>availabilityUrls</var>, run the following step:
                  <ol>
                    <li>For each <var>display</var> in <var>newDisplays</var>,
                    if <var>display</var> is an <a>available presentation
                    display</a> for <var>availabilityUrl</var>, then run the
                    following steps:
                      <ol>
                        <li>Insert a tuple <var>(availabilityUrl,
                        display)</var> into the <a>list of available
                        presentation displays</a>, if no identical tuple
                        already exists.
                        </li>
                        <li>Set <var>newAvailability</var> to
                        <code>true</code>.
                        </li>
                      </ol>
                    </li>
                  </ol>
                </li>
                <li>If <var>A</var>'s <a>value</a> property has not yet been
                initialized, then set <var>A</var>'s <a>value</a> property to
                <var>newAvailability</var> and skip the following step.
                </li>
                <li>If <var>previousAvailability</var> is not equal to
                <var>newAvailability</var>, then <a>queue a task</a> to run the
                following steps:
                  <ol>
                    <li>Set <var>A</var>'s <a>value</a> property to
                    <var>newAvailability</var>.
                    </li>
                    <li>
                      <a>Fire a simple event</a> named <a>change</a> at
                      <var>A</var>.
                    </li>
                  </ol>
                </li>
              </ol>
            </li>
          </ol>
          <div class="note">
            The <a>controlling user agent</a> may choose how often to
            <a>monitor the list of available presentation displays</a>,
            including grouping requests from <a for=
            "PresentationRequest">start</a> and <a for=
            "PresentationRequest">getAvailability</a>, and aggregating them
            across <a data-lt="browsing context">browsing contexts</a>.
          </div>
          <p>
            When a <a>presentation display availability</a> object is eligible
            for garbage collection, the <a>user agent</a> SHOULD run the
            following steps:
          </p>
          <ol>
            <li>Let <var>A</var> be the newly deceased
            <a>PresentationAvailability</a> object
            </li>
            <li>Find and remove any entry <em>(<var>A</var>,
            <var>availabilityUrl</var>)</em> in the <a>set of presentation
            availability objects</a>.
            </li>
            <li>If the <a>set of presentation availability objects</a> is now
            empty and there is no pending request to <a for=
            "PresentationRequest" data-lt="start">select a presentation
            display</a>, cancel any pending task to <a>monitor the list of
            available presentation displays</a> for power saving purposes, and
            set the <a>list of available presentation displays</a> to the empty
            list.
            </li>
          </ol>
          <div class="note">
            The mechanism used to monitor <a>presentation displays</a>
            availability and determine the compatibility of a <a>presentation
            display</a> with a given URL is left to the user agent.
          </div>
        </section>
        <section>
          <h4>
            Interface <dfn>PresentationConnectionAvailableEvent</dfn>
          </h4>
          <pre class="idl">
            [Constructor(DOMString type, PresentationConnectionAvailableEventInit eventInitDict)]
            interface PresentationConnectionAvailableEvent : Event {
              [SameObject] readonly attribute PresentationConnection connection;
            };

            dictionary PresentationConnectionAvailableEventInit : EventInit {
              required PresentationConnection connection;
            };


</pre>
          <p>
            A <a>controlling user agent</a> <a>fires</a> a <a>trusted event</a>
            named <a for="PresentationRequest">connectionavailable</a> on a
            <a>PresentationRequest</a> when a connection associated with the
            object is created. It is fired at the <a>PresentationRequest</a>
            instance, using the <a>PresentationConnectionAvailableEvent</a>
            interface, with the <a for=
            "PresentationConnectionAvailableEvent">connection</a> attribute set
            to the <a><code>PresentationConnection</code></a> object that was
            created. The event is fired for each connection that is created for
            the <a>controller</a>, either by the <a>controller</a> calling
            <a for="PresentationRequest">start</a> or <a for=
            "PresentationRequest">reconnect</a>, or by the <a>controlling user
            agent</a> creating a connection on the controller's behalf via
            <a for="Presentation"><code>defaultRequest</code></a>.
          </p>
          <p>
            A <a>receiving user agent</a> <a>fires</a> a <a>trusted event</a>
            named <a for="PresentationConnectionList">connectionavailable</a>
            on a <a>PresentationReceiver</a> when an incoming connection is
            created. It is fired at the <a>presentation controllers
            monitor</a>, using the <a>PresentationConnectionAvailableEvent</a>
            interface, with the <a for=
            "PresentationConnectionAvailableEvent">connection</a> attribute set
            to the <a><code>PresentationConnection</code></a> object that was
            created. The event is fired for all connections that are created
            when <a>monitoring incoming presentation connections</a>.
          </p>
          <p>
            The <dfn for=
            "PresentationConnectionAvailableEvent">connection</dfn> attribute
            MUST return the value it was set to when the
            <a>PresentationConnection</a> object was created.
          </p>
          <p>
            When the <a>PresentationConnectionAvailableEvent</a> constructor is
            called, the <a>user agent</a> MUST construct a new
            <a>PresentationConnectionAvailableEvent</a> object with its <a for=
            "PresentationConnectionAvailableEvent">connection</a> attribute set
            to the <dfn for=
            "PresentationConnectionAvailableEventInit">connection</dfn> member
            of the <dfn>PresentationConnectionAvailableEventInit</dfn> object
            passed to the constructor.
          </p>
        </section>
      </section>
      <section>
        <h3>
          Interface <dfn>PresentationConnection</dfn>
        </h3>
        <p>
          Each <a>presentation connection</a> is represented by a
          <a>PresentationConnection</a> object. Both the <a>controlling user
          agent</a> and <a>receiving user agent</a> MUST implement
          <a>PresentationConnection</a>.
        </p>
        <pre class="idl">
          enum PresentationConnectionState { "connecting", "connected", "closed", "terminated" };
          enum BinaryType { "blob", "arraybuffer" };

          interface PresentationConnection : EventTarget {
            readonly attribute USVString id;
            readonly attribute USVString url;
            readonly attribute PresentationConnectionState state;
            void close();
            void terminate();
            attribute EventHandler onconnect;
            attribute EventHandler onclose;
            attribute EventHandler onterminate;

            // Communication
            attribute BinaryType binaryType;
            attribute EventHandler onmessage;
            void send (DOMString message);
            void send (Blob data);
            void send (ArrayBuffer data);
            void send (ArrayBufferView data);
          };

</pre>
        <div dfn-for="PresentationConnection" link-for=
        "PresentationConnection">
          <p>
            The <dfn><code>id</code></dfn> attribute specifies the
            <a>presentation connection</a>'s <a>presentation identifier</a>.
          </p>
          <p>
            The <dfn><code>url</code></dfn> attribute specifies the
            <a>presentation connection</a>'s <a>presentation URL</a>.
          </p>
          <p>
            The <dfn><code>state</code></dfn> attribute represents the
            <a>presentation connection</a>'s current state. It can take one of
            the values of <dfn>PresentationConnectionState</dfn> depending on
            the connection state:
          </p>
          <ul dfn-for="PresentationConnectionState">
            <li>
              <dfn>connecting</dfn> means that the user agent is attempting to
              <a>establish a presentation connection</a> with the
              <a>destination browsing context</a>. This is the initial state
              when a <a>PresentationConnection</a> object is created.
            </li>
            <li>
              <dfn>connected</dfn> means that the <a>presentation
              connection</a> is established and communication is possible.
            </li>
            <li>
              <dfn>closed</dfn> means that the <a>presentation connection</a>
              has been closed, or could not be opened. It may be re-opened
              through a call to <a for="PresentationRequest">reconnect</a>. No
              communication is possible.
            </li>
            <li>
              <dfn>terminated</dfn> means that the <a>receiving browsing
              context</a> has been terminated. Any <a>presentation
              connection</a> to that <a href=
              "#dfn-receiving-browsing-context">presentation</a> is also
              terminated and cannot be re-opened. No communication is possible.
            </li>
          </ul>
          <p>
            When the <dfn>close</dfn> method is called on a
            <a>PresentationConnection</a> <var>S</var>, the <a>user agent</a>
            MUST <a>start closing the presentation connection</a> <var>S</var>
            with <a for="PresentationConnectionCloseReason">closed</a> as
            <var>closeReason</var> and an empty message as
            <var>closeMessage</var>.
          </p>
          <p>
            When the <dfn>terminate</dfn> method is called on a
            <a>PresentationConnection</a> <var>S</var> in a <a>controlling
            browsing context</a>, the <a>user agent</a> MUST run the algorithm
            to <a>terminate a presentation in a controlling browsing
            context</a> using <var>S</var>.
          </p>
          <p>
            When the <a>terminate</a> method is called on a
            <a>PresentationConnection</a> <var>S</var> in a <a>receiving
            browsing context</a>, the <a>user agent</a> MUST run the algorithm
            to <a>terminate a presentation in a receiving browsing context</a>
            using <var>S</var>.
          </p>
          <p>
            The <dfn>binaryType</dfn> attribute can take one of the values of
            <dfn for="">BinaryType</dfn>. When a <a>PresentationConnection</a>
            object is created, its <a>binaryType</a> attribute MUST be set to
            the string "<a link-for="BinaryType">arraybuffer</a>". On getting,
            it MUST return the last value it was set to. On setting, the user
            agent MUST set the attribute to the new value.
          </p>
          <div class="note">
            The <a>binaryType</a> attribute allows authors to control how
            binary data is exposed to scripts. By setting the attribute to
            "<dfn dfn-for="BinaryType">blob</dfn>", binary data is returned in
            <a>Blob</a> form; by setting it to "<dfn dfn-for=
            "BinaryType">arraybuffer</dfn>", it is returned in
            <a>ArrayBuffer</a> form. The attribute defaults to
            "<code>arraybuffer</code>". This attribute has no effect on data
            sent in a string form.
          </div>
          <p>
            When the <dfn data-lt=
            "send!overload-1|send!overload-2|send!overload-3">send</dfn> method
            is called on a <a>PresentationConnection</a> <var>S</var>, the
            <a>user agent</a> MUST run the algorithm to <a>send a message</a>
            through <var>S</var>.
          </p>
          <p>
            When a <a>PresentationConnection</a> object <var>S</var> is
            discarded (because the document owning it is navigating or is
            closed) while the <a>presentation connection state</a> of
            <var>S</var> is <a for="PresentationConnectionState">connecting</a>
            or <a for="PresentationConnectionState">connected</a>, the <a>user
            agent</a> SHOULD <a>start closing the presentation connection</a>
            <var>S</var> with <a for=
            "PresentationConnectionCloseReason">wentaway</a> as
            <var>closeReason</var> and an empty <var>closeMessage</var>.
          </p>
          <p>
            If the <a>user agent</a> receives a signal from the <a>destination
            browsing context</a> that a <a>PresentationConnection</a>
            <var>S</var> is to be closed, it SHOULD <a>close the presentation
            connection</a> <var>S</var> with <a for=
            "PresentationConnectionCloseReason">closed</a> or <a for=
            "PresentationConnectionCloseReason">wentaway</a> as
            <var>closeReason</var> and an empty <var>closeMessage</var>.
          </p>
        </div>
        <section>
          <h4>
            Establishing a presentation connection
          </h4>
          <p>
            When the <a>user agent</a> is to <dfn>establish a presentation
            connection</dfn> using a <a>presentation connection</a>, it MUST
            run the following steps:
          </p>
          <dl>
            <dt>
              Input
            </dt>
            <dd>
              <var>presentationConnection</var>, the
              <a>PresentationConnection</a> object that is to be connected
            </dd>
          </dl>
          <ol>
            <li>If the <a>presentation connection state</a> of
            <var>presentationConnection</var> is not <a for=
            "PresentationConnectionState">connecting</a>, then abort all
            remaining steps.
            </li>
            <li>Request connection of <var>presentationConnection</var> to the
            <a>receiving browsing context</a>. The <a>presentation
            identifier</a> of <var>presentationConnection</var> MUST be sent
            with this request.
            </li>
            <li>If connection completes successfully, <a>queue a task</a> to
            run the following steps:
              <ol>
                <li>Set the <a>presentation connection state</a> of
                <var>presentationConnection</var> to <a for=
                "PresentationConnectionState">connected</a>.
                </li>
                <li>
                  <a>Fire a simple event</a> named <a class=
                  "PresentationConnectionEvent">connect</a> at
                  <var>presentationConnection</var>.
                </li>
              </ol>
            </li>
            <li>If the connection cannot be completed, <a>close the
            presentation connection</a> <var>S</var> with <a for=
            "PresentationConnectionCloseReason">error</a> as
            <var>closeReason</var>, and a human readable message describing the
            failure as <var>closeMessage</var>.
            </li>
          </ol>
          <div class="note">
            The mechanism that is used to present on the remote display and
            connect the <a>controlling browsing context</a> with the presented
            document is an implementation choice of the user agent. The
            connection must provide a two-way messaging abstraction capable of
            carrying <code>DOMString</code> payloads in a reliable and in-order
            fashion as described in the <a>Send a Message</a> and <a>Receive a
            Message</a> steps below.
          </div>
        </section>
        <section>
          <h4>
            Sending a message through <a>PresentationConnection</a>
          </h4>
          <div class="note">
            No specific transport for the connection between the <a>controlling
            browsing context</a> and the <a>receiving browsing context</a> is
            mandated, except that for multiple calls to <a for=
            "PresentationConnection">send</a> it has to be ensured that
            messages are delivered to the other end reliably and in sequence.
            The transport should function equivalently to an
            <a><code>RTCDataChannel</code></a> in reliable mode.
          </div>
          <p>
            Let <dfn>presentation message data</dfn> be the payload data to be
            transmitted between two browsing contexts. Let <dfn>presentation
            message type</dfn> be the type of that data, one of
            <code>text</code> or <code>binary</code>.
          </p>
          <p>
            When the <a>user agent</a> is to <dfn data-lt="send-algorithm">send
            a message</dfn> through a <a>presentation connection</a>, it MUST
            run the following steps:
          </p>
          <dl>
            <dt>
              Input
            </dt>
            <dd>
              <var>presentationConnection</var>, the <a>presentation
              connection</a> connected to the other browsing context
            </dd>
            <dd>
              <var>messageOrData</var>, the <a>presentation message data</a> to
              send to the other browsing context
            </dd>
          </dl>
          <ol link-for="PresentationConnection">
            <li>If the <a>state</a> property of
            <var>presentationConnection</var> is not <a for=
            "PresentationConnectionState">connected</a>, <a>throw</a> an <code>
              InvalidStateError</code> exception.
            </li>
            <li>If the <a>closing procedure</a> of
            <var>presentationConnection</var> has started, then abort these
            steps.
            </li>
            <li>Let <a>presentation message type</a> <var>messageType</var> be
            <code>binary</code> if <var>messageOrData</var> is of type
            <a>ArrayBuffer</a>, <a>ArrayBufferView</a>, or <a>Blob</a>. Let
            <var>messageType</var> be <code>text</code> if
            <var>messageOrData</var> is of type <code>DOMString</code>.
            </li>
            <li>Using an implementation specific mechanism, transmit the
            contents of <var>messageOrData</var> as the <a>presentation message
            data</a> and <var>messageType</var> as the <a>presentation message
            type</a> to the <a>destination browsing context</a>.
            </li>
            <li>If the previous step encounters an unrecoverable error, then
            abruptly <a>close the presentation connection</a>
            <var>presentationConnection</var> with <a for=
            "PresentationConnectionCloseReason">error</a> as
            <var>closeReason</var>, and a <var>closeMessage</var> describing
            the error encountered.
            </li>
          </ol>
          <div class="note">
            <p>
              To assist applications in recovery from an error sending a
              message through a <a>presentation connection</a>, the user agent
              should include details of which attempt failed in
              <var>closeMessage</var>, along with a human readable string
              explaining the failure reason. Example renditions of
              <var>closeMessage</var>:
            </p>
            <ul>
              <li>
                <code>Unable to send text message (network_error):
                "hello"</code> for <code>DOMString</code> messages, where
                <code>"hello"</code> is the first 256 characters of the failed
                message.
              </li>
              <li>
                <code>Unable to send binary message (invalid_message)</code>
                for <a>ArrayBuffer</a>, <a>ArrayBufferView</a> and <a>Blob</a>
                messages.
              </li>
            </ul>
          </div>
          <div class="note">
            When sending a user-visible string via a <a>presentation
            connection</a>, the page author should take care to ensure that
            locale information is also propagated so that the destination user
            agent can know how to best render the string. See <a href=
            "#passing-locale-information-with-a-message">the examples</a> for
            one solution.
          </div>
        </section>
        <section>
          <h4>
            Receiving a message through <a>PresentationConnection</a>
          </h4>
          <p>
            When the <a>user agent</a> has received a transmission from the
            remote side consisting of <a>presentation message data</a> and
            <a>presentation message type</a>, it MUST run the following steps
            to <dfn data-lt="receive-algorithm">receive a message</dfn> through
            a <a>PresentationConnection</a>:
          </p>
          <dl>
            <dt>
              Input
            </dt>
            <dd>
              <var>presentationConnection</var>, the <a>presentation
              connection</a> receiving the message
            </dd>
            <dd>
              <var>messageType</var>, the <a>presentation message type</a> of
              the message
            </dd>
            <dd>
              <var>messageData</var>, the <a>presentation message data</a> of
              the message
            </dd>
          </dl>
          <ol link-for="PresentationConnection">
            <li>If the <a>state</a> property of
            <var>presentationConnection</var> is not <a for=
            "PresentationConnectionState">connected</a>, abort these steps.
            </li>
            <li>Let <var>event</var> be a newly created <a>trusted event</a>
            that uses the <a>MessageEvent</a> interface, with the event type
            <a>message</a>, which does not bubble, is not cancelable, and has
            no default action.
            </li>
            <li>Initialize the <var>event</var>'s data attribute as follows:
              <ol>
                <li>If <var>messageType</var> is <code>text</code>, then
                initialize <var>event</var>'s <code>data</code> attribute to
                <var>messageData</var> with type <code>DOMString</code>.
                </li>
                <li>If <var>messageType</var> is <code>binary</code>, and
                <a>binaryType</a> attribute is set to "<a link-for=
                "BinaryType">blob</a>", then initialize <var>event</var>'s
                <code>data</code> attribute to a new <a>Blob</a> object with
                <var>messageData</var> as its raw data.
                </li>
                <li>If <var>messageType</var> is <code>binary</code>, and
                <a>binaryType</a> attribute is set to "<a link-for=
                "BinaryType">arraybuffer</a>", then initialize
                <var>event</var>'s <code>data</code> attribute to a new
                <a>ArrayBuffer</a> object whose contents are
                <var>messageData</var>.
                </li>
              </ol>
            </li>
            <li>
              <a>Queue a task</a> to <a>fire</a> <var>event</var> at
              <var>presentationConnection</var>.
            </li>
          </ol>
          <p>
            If the <a>user agent</a> encounters an unrecoverable error while
            <a data-lt="receive-algorithm">receiving a message</a> through
            <var>presentationConnection</var>, it SHOULD abruptly <a>close the
            presentation connection</a> <var>presentationConnection</var> with
            <a for="PresentationConnectionCloseReason">error</a> as
            <var>closeReason</var>, and a human readable description of the
            error encountered as <var>closeMessage</var>.
          </p>
        </section>
        <section>
          <h4>
            Interface <dfn>PresentationConnectionCloseEvent</dfn>
          </h4>
          <pre class="idl">
            enum PresentationConnectionCloseReason { "error", "closed", "wentaway" };

            [Constructor(DOMString type, PresentationConnectionCloseEventInit eventInitDict)]
            interface PresentationConnectionCloseEvent : Event {
              readonly attribute PresentationConnectionCloseReason reason;
              readonly attribute DOMString message;
            };

            dictionary PresentationConnectionCloseEventInit : EventInit {
              required PresentationConnectionCloseReason reason;
              DOMString message = "";
            };


</pre>
          <p>
            A <a>PresentationConnectionCloseEvent</a> is fired when a
            <a>presentation connection</a> enters a <a for=
            "PresentationConnectionState">closed</a> state. The <dfn for=
            "PresentationConnectionCloseEvent">reason</dfn> attribute provides
            the reason why the connection was closed. It can take one of the
            values of <dfn>PresentationConnectionCloseReason</dfn>:
          </p>
          <ul dfn-for="PresentationConnectionCloseReason">
            <li>
              <dfn>error</dfn> means that the mechanism for connecting or
              communicating with a presentation entered an unrecoverable error.
            </li>
            <li>
              <dfn>closed</dfn> means that either the <a>controlling browsing
              context</a> or the <a>receiving browsing context</a> that were
              connected by the <a>PresentationConnection</a> called <a for=
              "PresentationConnection">close</a>.
            </li>
            <li>
              <dfn>wentaway</dfn> means that the browser closed the connection,
              for example, because the browsing context that owned the
              connection navigated or was discarded.
            </li>
          </ul>
          <p>
            When the <a for="PresentationConnectionCloseEvent">reason</a>
            attribute is <a for="PresentationConnectionCloseReason">error</a>,
            the user agent SHOULD set the <dfn for=
            "PresentationConnectionCloseEvent">message</dfn> attribute to a
            human readable description of how the communication channel
            encountered an error.
          </p>
          <p>
            When the <a>PresentationConnectionCloseEvent</a> constructor is
            called, the <a>user agent</a> MUST construct a new
            <a>PresentationConnectionCloseEvent</a> object, with its <a for=
            "PresentationConnectionCloseEvent">reason</a> attribute set to the
            <dfn for="PresentationConnectionCloseEventInit">reason</dfn> member
            of the <dfn>PresentationConnectionCloseEventInit</dfn> object
            passed to the constructor, and its <a for=
            "PresentationConnectionCloseEvent">message</a> attribute set to the
            <dfn for="PresentationConnectionCloseEventInit">message</dfn>
            member of this <a>PresentationConnectionCloseEventInit</a> object
            if set, to an empty string otherwise.
          </p>
        </section>
        <section>
          <h4>
            Closing a <a>PresentationConnection</a>
          </h4>
          <p>
            When the <a>user agent</a> is to <dfn data-lt=
            "start closing the presentation connection|closing procedure">start
            closing a presentation connection</dfn>, it MUST do the following:
          </p>
          <dl>
            <dt>
              Input
            </dt>
            <dd>
              <var>presentationConnection</var>, the <a>presentation
              connection</a> to be closed
            </dd>
            <dd>
              <var>closeReason</var>, the
              <a>PresentationConnectionCloseReason</a> describing why the
              connection is to be closed
            </dd>
            <dd>
              <var>closeMessage</var>, a human-readable message with details of
              why the connection was closed
            </dd>
          </dl>
          <ol>
            <li>If the <a>presentation connection state</a> of
            <var>presentationConnection</var> is not <a for=
            "PresentationConnectionState">connecting</a> or <a for=
            "PresentationConnectionState">connected</a> then abort the
            remaining steps.
            </li>
            <li>Set the <a>presentation connection state</a> of
            <var>presentationConnection</var> to <a for=
            "PresentationConnectionState">closed</a>.
            </li>
            <li>Start to signal to the <a>destination browsing context</a> the
            intention to close the corresponding <a>PresentationConnection</a>,
            passing the <var>closeReason</var> to that context. The user agent
            does not need to wait for acknowledgement that the corresponding
            <a>PresentationConnection</a> was actually closed before proceeding
            to the next step.
            </li>
            <li>If <var>closeReason</var> is not <a for=
            "PresentationConnectionCloseReason">wentaway</a>, then locally run
            the steps to <a>close the presentation connection</a> with
            <var>presentationConnection</var>, <var>closeReason</var>, and
            <var>closeMessage</var>.
            </li>
          </ol>
          <p>
            When the <a>user agent</a> is to <dfn data-lt=
            "close the presentation connection">close a presentation
            connection</dfn>, it MUST do the following:
          </p>
          <dl>
            <dt>
              Input
            </dt>
            <dd>
              <var>presentationConnection</var>, the <a>presentation
              connection</a> to be closed
            </dd>
            <dd>
              <var>closeReason</var>, the
              <a>PresentationConnectionCloseReason</a> describing why the
              connection is to be closed
            </dd>
            <dd>
              <var>closeMessage</var>, a human-readable message with details of
              why the connection was closed.
            </dd>
          </dl>
          <ol>
            <li>If there is a pending <a>close the presentation connection</a>
            task for <var>presentationConnection</var>, or a <a>close the
            presentation connection</a> task has already run for
            <var>presentationConnection</var>, then abort the remaining steps.
            </li>
            <li>
              <a>Queue a task</a> to run the following steps:
              <ol>
                <li>If the <a>presentation connection state</a> of
                <var>presentationConnection</var> is not <a for=
                "PresentationConnectionState">connecting</a>, <a for=
                "PresentationConnectionState">connected</a>, or <a for=
                "PresentationConnectionState">closed</a>, then abort the
                remaining steps.
                </li>
                <li>If the <a>presentation connection state</a> of
                <var>presentationConnection</var> is not <a for=
                "PresentationConnectionState">closed</a>, set it to <a for=
                "PresentationConnectionState">closed</a>.
                </li>
                <li>
                  <a>Fire</a> a <a>trusted event</a> with the name <a for=
                  "PresentationConnectionEvent">close</a>, that uses the
                  <a>PresentationConnectionCloseEvent</a> interface, with the
                  <a for="PresentationConnectionCloseEvent">reason</a>
                  attribute initialized to <var>closeReason</var> and the
                  <a for="PresentationConnectionCloseEvent">message</a>
                  attribute initialized to <var>closeMessage</var>, at
                  <var>presentationConnection</var>. The event must not bubble,
                  must not be cancelable, and has no default action.
                </li>
              </ol>
            </li>
          </ol>
        </section>
        <section>
          <h4>
            Terminating a presentation in a controlling browsing context
          </h4>
          <p>
            When a <a>controlling user agent</a> is to <dfn data-lt=
            "terminate-algorithm-controlling">terminate a presentation in a
            controlling browsing context</dfn> using <var>connection</var>, it
            MUST run the following steps:
          </p>
          <ol>
            <li>If the <a>presentation connection state</a> of
            <var>connection</var> is not <a for="PresentationConnectionState">
              connected</a>, then abort these steps.
            </li>
            <li>Otherwise, for each <var>known connection</var> in the <a>set
            of controlled presentations</a> in the <a>controlling user
            agent</a>:
              <ol>
                <li>If the <a>presentation identifier</a> of <var>known
                connection</var> and <var>connection</var> are equal, and the
                <a>presentation connection state</a> of <var>known
                connection</var> is <a for=
                "PresentationConnectionState">connected</a>, then <a>queue a
                task</a> to run the following steps:
                  <ol>
                    <li>Set the <a>presentation connection state</a> of
                    <var>known connection</var> to <a for=
                    "PresentationConnectionState">terminated</a>.
                    </li>
                    <li>
                      <a>Fire a simple event</a> named <a for=
                      "PresentationConnectionEvent">terminate</a> at <var>known
                      connection</var>.
                    </li>
                  </ol>
                </li>
              </ol>
            </li>
            <li>
              <dfn>Send a termination request</dfn> for the presentation to its
              <a>receiving user agent</a> using an implementation specific
              mechanism.
            </li>
          </ol>
        </section>
        <section>
          <h4>
            Terminating a presentation in a receiving browsing context
          </h4>
          <p>
            When any of the following occur, the <a>receiving user agent</a>
            MUST <a>terminate a presentation in a receiving browsing
            context</a>:
          </p>
          <ol>
            <li>The <a>receiving user agent</a> is to <a>unload a document</a>
            corresponding to the <a>receiving browsing context</a>, e.g. in
            response to a call to <code>window.close()</code> in the
            <a>top-level browsing context</a> or to a request to
            <a>navigate</a> that context to a new resource.
            </li>
            <li>The user requests to terminate the presentation via the
            <a>receiving user agent</a>.
              <p class="note">
                This could happen by an explicit user action, or as a policy of
                the user agent. For example, the <a>receiving user agent</a>
                could be configured to terminate presentations that have no
                <a>PresentationConnection</a> objects whose <a>presentation
                connection state</a> is in the <a link-for=
                "PresentationConnectionState">connected</a> state after 30
                minutes.
              </p>
            </li>
            <li>A <a>controlling user agent</a> <a data-lt=
            "send a termination request">sends a termination request</a> to the
            <a>receiving user agent</a> for that presentation.
            </li>
          </ol>
          <p>
            When a <a>receiving user agent</a> is to <dfn data-lt=
            "terminate-algorithm-receiving">terminate a presentation in a
            receiving browsing context</dfn>, it MUST run the following steps:
          </p>
          <ol>
            <li>Let <var>P</var> be the presentation to be terminated, let
            <var>allControllers</var> be the <a>set of presentation
            controllers</a> that were created for <var>P</var>, and
            <var>connectedControllers</var> an empty list.
            </li>
            <li>For each <var>connection</var> in <var>allControllers</var>,
            run the following steps:
              <ol>
                <li>If the <a>presentation connection state</a> of
                <var>connection</var> is <a for="PresentationConnectionState">
                  connected</a>, then add <var>connection</var> to
                  <var>connectedControllers</var>.
                </li>
                <li>Set the <a>presentation connection state</a> of
                <var>connection</var> to <a for="PresentationConnectionState">
                  terminated</a>.
                </li>
              </ol>
            </li>
            <li>If there is a <a>receiving browsing context</a> for
            <var>P</var>, and it has a document for <var>P</var> that is not
            unloaded, <a>unload a document</a> corresponding to that
            <a>browsing context</a>.
            </li>
            <li>For each <var>connection</var> in
            <var>connectedControllers</var>, <a>queue a task</a> to send a
            termination confirmation for <var>P</var> using an implementation
            specific mechanism to the <a>controlling user agent</a> that owns
            the <a>destination browsing context</a> for <var>connection</var>.
              <p class="note">
                Only one termination confirmation needs to be sent per
                <a>controlling user agent</a>.
              </p>
            </li>
          </ol>
        </section>
        <section>
          <h4>
            Handling a termination confirmation in a controlling user agent
          </h4>
          <p>
            When a <a>receiving user agent</a> is to <dfn>send a termination
            confirmation</dfn> for a presentation <var>P</var>, and that
            confirmation was received by a <a>controlling user agent</a>, the
            <a>controlling user agent</a> SHOULD run the following steps:
          </p>
          <ol>
            <li>For each <var>connection</var> in the <a>set of controlled
            presentations</a> that was connected to <var>P</var>, <a>queue a
            task</a> to run the following steps:
              <ol>
                <li>If the <a>presentation connection state</a> of
                <var>connection</var> is not <a for=
                "PresentationConnectionState">connected</a>, then abort the
                following steps.
                </li>
                <li>Set the <a>presentation connection state</a> of
                <var>connection</var> to <a for="PresentationConnectionState">
                  terminated</a>.
                </li>
                <li>
                  <a>Fire a simple event</a> named <a for=
                  "PresentationConnectionEvent">terminate</a> at
                  <var>connection</var>.
                </li>
              </ol>
            </li>
          </ol>
        </section>
        <section>
          <h4>
            Event Handlers
          </h4>
          <p>
            The following are the event handlers (and their corresponding event
            handler event types) that must be supported, as event handler IDL
            attributes, by objects implementing the
            <a>PresentationConnection</a> interface:
          </p>
          <table dfn-for="PresentationConnection">
            <thead>
              <tr>
                <th>
                  Event handler
                </th>
                <th>
                  Event handler event type
                </th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td>
                  <dfn><code>onmessage</code></dfn>
                </td>
                <td>
                  <dfn><code>message</code></dfn>
                </td>
              </tr>
              <tr>
                <td>
                  <dfn><code>onconnect</code></dfn>
                </td>
                <td>
                  <dfn><code>connect</code></dfn>
                </td>
              </tr>
              <tr>
                <td>
                  <dfn><code>onclose</code></dfn>
                </td>
                <td>
                  <dfn for=
                  "PresentationConnectionEvent"><code>close</code></dfn>
                </td>
              </tr>
              <tr>
                <td>
                  <dfn><code>onterminate</code></dfn>
                </td>
                <td>
                  <dfn for=
                  "PresentationConnectionEvent"><code>terminate</code></dfn>
                </td>
              </tr>
            </tbody>
          </table>
        </section>
      </section>
      <section>
        <h3>
          Interface <dfn>PresentationReceiver</dfn>
        </h3>
        <pre class="idl">
          interface PresentationReceiver {
            readonly attribute Promise&lt;PresentationConnectionList&gt; connectionList;
          };


</pre>
        <p>
          The <a>PresentationReceiver</a> interface allows a <a>receiving
          browsing context</a> to access the <a data-lt=
          "controlling browsing context">controlling browsing contexts</a> and
          communicate with them. The <a>PresentationReceiver</a> interface MUST
          be implemented in a <a>receiving browsing context</a> provided by a
          <a>receiving user agent</a>.
        </p>
        <p>
          On getting, the <dfn for="PresentationReceiver">connectionList</dfn>
          attribute MUST return the result of running the following steps:
        </p>
        <ol>
          <li>If the <a>presentation controllers promise</a> is not
          <code>null</code>, return the <a>presentation controllers promise</a>
          and abort all remaining steps.
          </li>
          <li>Otherwise, let the <a>presentation controllers promise</a> be a
          new <a>Promise</a> constructed in the <a>JavaScript realm</a> of this
          <a>PresentationReceiver</a> object.
          </li>
          <li>Return the <a>presentation controllers promise</a>.
          </li>
          <li>If the <a>presentation controllers monitor</a> is not
          <code>null</code>, <a>resolve</a> the <a>presentation controllers
          promise</a> with the <a>presentation controllers monitor</a>.
          </li>
        </ol>
        <section>
          <h4>
            Creating a receiving browsing context
          </h4>
          <p>
            When the <a>user agent</a> is to <dfn>create a receiving browsing
            context</dfn>, it MUST run the following steps:
          </p>
          <dl>
            <dt>
              Input
            </dt>
            <dd>
              <var>D</var>, a <a>presentation display</a> chosen by the user
            </dd>
            <dd>
              <var>presentationUrl</var>, the <a>presentation request URL</a>
            </dd>
            <dd>
              <var>presentationId</var>, the <a>presentation identifier</a>
            </dd>
          </dl>
          <ol>
            <li>
              <a data-lt="creating a new browsing context">Create</a> a new
              <a>top-level browsing context</a> <var>C</var>, set to display
              content on <var>D</var>.
            </li>
            <li>Set the <a>session history</a> of <var>C</var> to be the empty
            list.
            </li>
            <li>Set the <a>sandboxed auxiliary navigation browsing context
            flag</a> on <var>C</var>.
            </li>
            <li>If the <a>receiving user agent</a> implements [[!PERMISSIONS]],
            set the <a>permission state</a> of all <a>Permissions</a> for <var>
              C</var> to <code>"denied"</code>.
            </li>
            <li>Create a new empty <a>cookie store</a> for <var>C</var>.
            </li>
            <li>Create a new empty store for <var>C</var> to hold <a>HTTP
            authentication</a> states.
            </li>
            <li>Create a new empty <a>application cache</a> storage for
            <var>C</var>.
            </li>
            <li>If the <a>receiving user agent</a> implements [[!INDEXEDDB]],
            create a new empty storage for IndexedDB <a>databases</a> for <var>
              C</var>.
            </li>
            <li>If the <a>receiving user agent</a> implements [[!WEBSTORAGE]],
            create a new empty storage for <a>session storage areas</a> and <a>
              local storage areas</a> for <var>C</var>.
            </li>
            <li>If the <a>receiving user agent</a> implements
            [[!SERVICE-WORKERS]], create a new empty <a>list of registered
            service worker registrations</a> and a new empty <a>caches</a> for
            <var>C</var>.
            </li>
            <li>
              <a>Navigate</a> <var>C</var> to <var>presentationUrl</var>.
            </li>
            <li>Start <a>monitoring incoming presentation connections</a> for
            <var>C</var> with <var>presentationId</var> and
            <var>presentationUrl</var>.
            </li>
          </ol>
          <p>
            All <a data-lt="nested browsing context">nested browsing
            contexts</a> <a data-lt=
            "creating a new browsing context">created</a> by the presented
            document, i.e. that have the <a>receiving browsing context</a> as
            their <a data-lt="top-level browsing context">top-level browsing
            context</a>, MUST also have restrictions 2-4 above. All of these
            <a>browsing contexts</a> MUST also share the same browsing state
            (storage) for features 5-10 listed above.
          </p>
          <p>
            <a>Window clients</a> and <a>worker clients</a> associated with the
            <a>receiving browsing context</a> and its <a>list of descendant
            browsing contexts</a> must not be exposed to <a>service workers</a>
            associated with each other.
          </p>
          <p>
            When the <a>receiving browsing context</a> is closed, any
            <a>service workers</a> associated with it and the <a>browsing
            contexts</a> in its <a>list of descendant browsing contexts</a>
            MUST be unregistered and terminated. Any browsing state associated
            with the <a>receiving browsing context</a> and the <a>browsing
            contexts</a> in its <a>list of descendant browsing contexts</a>,
            including <a>session history</a>, the <a>cookie store</a>, any
            <a>HTTP authentication</a> state, the <a>application cache</a>, any
            <a>databases</a>, the <a>session storage areas</a>, the <a>local
            storage areas</a>, the <a>list of registered service worker
            registrations</a> and the <a>caches</a> MUST be discarded and not
            used for any other <a>browsing context</a>.
          </p>
          <p class="note">
            This algorithm is intended to create a well defined environment to
            allow interoperable behavior for 1-UA and 2-UA presentations.
          </p>
          <p>
            The <a>receiving user agent</a> SHOULD fetch resources in a
            <a>receiving browsing context</a> with an HTTP
            <a>Accept-Language</a> header that reflects the language
            preferences of the <a>controlling user agent</a> (i.e., with the
            same <a>Accept-Language</a> that the controlling user agent would
            have sent). This will help the <a>receiving user agent</a> render
            the presentation with fonts and locale-specific attributes that
            reflect the user's preferences.
          </p>
          <p class="note">
            Given the operating context of the <a>presentation display</a>,
            some APIs will not work by design (for example, by requiring user
            input) or will be obsolete (for example, by attempting window
            management); the <a>receiving user agent</a> should be aware of
            this. Furthermore, any modal user interface will need to be handled
            carefully.
          </p>
        </section>
      </section>
      <section>
        <h3>
          Interface <dfn>PresentationConnectionList</dfn>
        </h3>
        <pre class="idl">
          interface PresentationConnectionList : EventTarget {
            readonly attribute FrozenArray&lt;PresentationConnection&gt; connections;
            attribute EventHandler onconnectionavailable;
          };


</pre>
        <p>
          The <dfn for="PresentationConnectionList">connections</dfn> attribute
          MUST return the non-terminated set of <a>presentation connections</a>
          in the <a>set of presentation controllers</a>.
        </p>
        <section>
          <h4>
            Monitoring incoming presentation connections
          </h4>
          <p>
            When the <a>receiving user agent</a> is to start <dfn>monitoring
            incoming presentation connections</dfn> in a <a>receiving browsing
            context</a> from <a>controlling browsing contexts</a>, it MUST
            listen to and accept incoming connection requests from a
            <a>controlling browsing context</a> using an implementation
            specific mechanism. When a new connection request is received from
            a <a>controlling browsing context</a>, the <a>receiving user
            agent</a> MUST run the following steps:
          </p>
          <dl>
            <dt>
              Input
            </dt>
            <dd>
              <var>I</var>, the <a>presentation identifier</a> passed by the
              <a>controlling browsing context</a> with the incoming connection
              request
            </dd>
            <dd>
              <var>presentationId</var>, the <a>presentation identifier</a>
              used to <a data-lt="create a receiving browsing context">create
              the receiving browsing context</a>
            </dd>
            <dd>
              <var>presentationUrl</var>, the <a>presentation request URL</a>
              used to <a data-lt="create a receiving browsing context">create
              the receiving browsing context</a>
            </dd>
          </dl>
          <ol>
            <li>If <var>presentationId</var> and <var>I</var> are not equal,
            refuse the connection and abort all remaining steps.
            </li>
            <li>Create a new <a>PresentationConnection</a> <var>S</var>.
            </li>
            <li>Set the <a>presentation identifier</a> of <var>S</var> to <var>
              I</var>.
            </li>
            <li>Set the <a>presentation URL</a> of <var>S</var> to
            <var>presentationUrl</var>.
            </li>
            <li>Establish the connection between the controlling and
            <a>receiving browsing contexts</a> using an implementation specific
            mechanism.
            </li>
            <li>If connection establishment completes successfully, set the <a>
              presentation connection state</a> of <var>S</var> to <a for=
              "PresentationConnectionState">connected</a>. Otherwise, set the
              <a>presentation connection state</a> of <var>S</var> to <a for=
              "PresentationConnectionState">closed</a> and abort all remaining
              steps.
            </li>
            <li>Add <var>S</var> to the <a>set of presentation controllers</a>.
            </li>
            <li>If the <a>presentation controllers monitor</a> is
            <code>null</code>, run the following steps <a>in parallel</a>.
              <ol>
                <li>Let the <a>presentation controllers monitor</a> be a new
                <a>PresentationConnectionList</a> constructed in the
                <a>JavaScript realm</a> of the <a>PresentationReceiver</a>
                object of the <a>receiving browsing context</a>.
                </li>
                <li>Populate the <a>presentation controllers monitor</a> with
                the <a>set of presentation controllers</a>.
                </li>
                <li>If the <a>presentation controllers promise</a> is not
                <code>null</code>, <a>resolve</a> the <a>presentation
                controllers promise</a> with the <a>presentation controllers
                monitor</a>.
                </li>
                <li>Abort all remaining steps.
                </li>
              </ol>
            </li>
            <li>Otherwise, run the following steps <a>in parallel</a>.
              <ol>
                <li>Populate the <a>presentation controllers monitor</a> with
                the <a>set of presentation controllers</a>.
                </li>
                <li>
                  <a>Queue a task</a> to <a>fire</a> a <a>trusted event</a>
                  with the name <a for=
                  "PresentationConnectionList">connectionavailable</a>, that
                  uses the <a>PresentationConnectionAvailableEvent</a>
                  interface, with the <a for=
                  "PresentationConnectionAvailableEvent">connection</a>
                  attribute initialized to <var>S</var>, at the <a>presentation
                  controllers monitor</a>. The event must not bubble, must not
                  be cancelable, and has no default action.
                </li>
              </ol>
            </li>
          </ol>
        </section>
        <section>
          <h4>
            Event Handlers
          </h4>
          <p>
            The following are the event handlers (and their corresponding event
            handler event types) that must be supported, as event handler IDL
            attributes, by objects implementing the
            <a>PresentationConnectionList</a> interface:
          </p>
          <table dfn-for="PresentationConnectionList">
            <thead>
              <tr>
                <th>
                  Event handler
                </th>
                <th>
                  Event handler event type
                </th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td>
                  <dfn><code>onconnectionavailable</code></dfn>
                </td>
                <td>
                  <code>connectionavailable</code>
                </td>
              </tr>
            </tbody>
          </table>
        </section>
      </section>
      <section>
        <h3>
          Sandboxing and the <code>allow-presentation</code> keyword
        </h3>
        <p>
          This specification adds a new token, <code>allow-presentation</code>,
          to the set of tokens allowed in the <code>sandbox</code> attribute of
          an <code>iframe</code>. It adds a corresponding new flag to the
          <a>sandboxing flag set</a>:
        </p>
        <dl>
          <dt>
            The <dfn id=
            "sandboxed-presentation-browsing-context-flag">sandboxed
            presentation browsing context flag</dfn>
          </dt>
          <dd>
            This flag disables the Presentation API.
          </dd>
        </dl>
        <p>
          It amends the <a>parse a sandboxing directive</a> algorithm by adding
          an item to step 3:
        </p>
        <ul>
          <li>The <a>sandboxed presentation browsing context flag</a>, unless
          <var>tokens</var> contains the <dfn id=
          "attr-iframe-sandbox-allow-presentation"><code>allow-presentation</code></dfn>
          keyword.
          </li>
        </ul>
      </section>
    </section>
    <section class="informative">
      <h2>
        Security and privacy considerations
      </h2>
      <section>
        <h3>
          Personally identifiable information
        </h3>
        <p>
          The <a>change</a> event fired on the <a>PresentationAvailability</a>
          object reveals one bit of information about the presence (or
          non-presence) of a <a>presentation display</a> typically discovered
          through the local area network. This could be used in conjunction
          with other information for fingerprinting the user. However, this
          information is also dependent on the user's local network context, so
          the risk is minimized.
        </p>
        <p>
          The API enables <a href=
          "#monitoring-the-list-of-available-presentation-displays">monitoring
          the list of available presentation displays</a>. How the user agent
          determines the compatibility and availability of a <a>presentation
          display</a> with a given URL is an implementation detail. If a
          <a>controlling user agent</a> matches a <a>presentation request
          URL</a> to a <a>DIAL</a> application to determine its availability,
          this feature can be used to probe information about which <a>DIAL</a>
          applications the user has installed on the <a>presentation
          display</a> without user consent.
        </p>
      </section>
      <section>
        <h3>
          Cross-origin access
        </h3>
        <p>
          A <a href="#dfn-receiving-browsing-context">presentation</a> is
          allowed to be accessed across origins; the presentation URL and
          presentation ID used to create the presentation are the only
          information needed to reconnect to a connection from any origin in
          that user agent. In other words, a presentation is not tied to a
          particular opening origin.
        </p>
        <p>
          This design allows controlling contexts from different domains to
          connect to a shared presentation resource. The security of the
          presentation ID prevents arbitrary pages from connecting to an
          existing presentation.
        </p>
        <p>
          This specification allows a user agent to publish information about
          its <a>set of controlled presentations</a>, and allows a browsing
          context on another user agent to connect to a running presentation
          via <a for="PresentationRequest">reconnect</a>. To connect, the
          additional browsing context must discover the presentation URL and
          presentation ID of the presentation, either provided by the user, or
          via a shared service.
        </p>
        <p>
          However, this specification makes no guarantee as to the identity of
          the connecting party. Once connected, the receiving application may
          wish to further verify the identity of the connecting party through
          application-specific means. For example, the connecting application
          could provide a token via <a for="PresentationConnection">send</a>
          that the receiving application could verify corresponds an authorized
          entity.
        </p>
      </section>
      <section>
        <h3>
          User interface guidelines
        </h3>
        <dl>
          <dt>
            Origin display
          </dt>
          <dd>
            <p>
              When the user is asked permission to use a <a>presentation
              display</a> during the steps to <a>select a presentation
              display</a>, the <a>controlling user agent</a> should make it
              clear what origin is requesting presentation <i>and</i> what
              origin will be presented.
            </p>
            <p>
              Display of the origin requesting presentation will help the user
              understand what content is making the request, especially when
              the request is initiated from a <a>nested browsing context</a>.
              For example, embedded content may try to convince the user to
              click to trigger a request to start an unwanted presentation.
            </p>
            <p>
              Showing the origin that will be presented will help the user know
              if that content is from an <a>potentially trustworthy origin</a>
              (e.g., <code>https:</code>), and corresponds to a known or
              expected site. The user agent should specifically indicate when
              the origin requesting presentation is not <a data-lt=
              "potentially trustworthy origin">potentially trustworthy</a>. For
              example, a malicious site may attempt to convince the user to
              enter login credentials into a presentation page that imitates a
              legitimate site. Examination of the requested origin will help
              the user detect these cases.
            </p>
          </dd>
          <dt>
            Cross-device access
          </dt>
          <dd>
            <p>
              When a user <a data-lt="start a presentation connection">starts a
              presentation</a>, the user will begin with exclusive control of
              the presentation. However, the Presentation API allows additional
              devices (likely belonging to distinct users) to connect and
              thereby control the presentation as well. When a second device
              connects to a presentation, it is recommended that all connected
              <a data-lt="controlling user agent">controlling user agents</a>
              notify their users via the browser chrome that the original user
              has lost exclusive access, and there are now multiple controllers
              for the presentation.
            </p>
            <p>
              In addition, it may be the case that the <a>receiving user
              agent</a> is capable of receiving user input, as well as acting
              as a <a>presentation display</a>. In this case, the <a>receiving
              user agent</a> should notify its user via browser chrome when a
              <a>receiving browsing context</a> is under the control of a
              remote party (i.e., it has one or more connected controllers).
            </p>
          </dd>
        </dl>
      </section>
      <section>
        <h3>
          Device Access
        </h3>
        <p>
          The presentation API abstracts away what "local" means for displays,
          meaning that it exposes network-accessible displays as though they
          were local displays. The Presentation API requires user permission
          for a page to access any display to mitigate issues that could arise,
          such as showing unwanted content on a display viewable by others.
        </p>
      </section>
      <section>
        <h3>
          Temporary identifiers and browser state
        </h3>
        <p>
          The presentation URL and presentation ID can be used to connect to a
          presentation from another browsing context. They can be intercepted
          if an attacker can inject content into the controlling page.
        </p>
      </section>
      <section>
        <h3>
          Incognito mode and clearing of browsing data
        </h3>
        <p>
          The content displayed on the presentation is different from the
          controller. In particular, if the user is logged in in both contexts,
          then logs out of the <a>controlling browsing context</a>, she will
          not be automatically logged out from the <a>receiving browsing
          context</a>. Applications that use authentication should pay extra
          care when communicating between devices.
        </p>
        <p>
          The set of presentations known to the user agent should be cleared
          when the user requests to "clear browsing data."
        </p>
        <p>
          When in private browsing mode ("incognito"), the initial <a>set of
          controlled presentations</a> in that browsing session must be empty.
          Any <a data-lt="presentation connection">presentation connections</a>
          added to it must be discarded when the session terminates.
        </p>
      </section>
      <section>
        <h3>
          Messaging between presentation connections
        </h3>
        <p>
          This spec will not mandate communication protocols between the
          <a>controlling browsing context</a> and the <a>receiving browsing
          context</a>, but it should set some guarantees of message
          confidentiality and authenticity between corresponding
          <a>presentation connections</a>.
        </p>
      </section>
    </section>
    <section class="appendix">
      <h2>
        Acknowledgments
      </h2>
      <p>
        Thanks to Addison Phillips, Anne Van Kesteren, Anssi Kostiainen, Anton
        Vayvod, Chris Needham, Christine Runnegar, Daniel Davis, Domenic
        Denicola, Erik Wilde, FranÃ§ois Daoust, éµæ´ªæ³¢ (Hongbo Min), Hongki CHA,
        Hubert SablonniÃ¨re, Hyojin Song, Hyun June Kim, Jean-Claude Dufourd,
        Joanmarie Diggs, Jonas Sicking, Louay Bassbouss, Mark Watson, Martin
        DÃ¼rst, Matt Hammond, Mike West, Mounir Lamouri, Nick Doty, Oleg
        Beletski, Philip JÃ¤genstedt, Richard Ishida, Shih-Chiang Chien, Takeshi
        Kanai, Tobie Langel, Tomoyuki Shimizu, Travis Leithead, and Wayne Carr
        for help with editing, reviews and feedback to this draft.
      </p>
    </section>
    <section class="appendix">
      <h2>
        CR exit criteria
      </h2>
      <p>
        For this specification to be advanced to Proposed Recommendation, there
        must be, for each of the conformance classes it defines (<a>controlling
        user agent</a> and <a>receiving user agent</a>), at least two
        independent, interoperable implementations of each feature. Each
        feature may be implemented by a different set of products, there is no
        requirement that all features be implemented by a single product.
        Additionally, implementations of the receiving user agent conformance
        class must include at least one implementation of the <a href=
        "#1-ua">1-UA</a> mode and one implementation of the <a href=
        "#2-ua">2-UA</a> mode.
      </p>
      <p>
        For the purposes of these criteria, we define the following terms:
      </p>
      <dl>
        <dt>
          Independent
        </dt>
        <dd>
          Each implementation must be developed by a different party, and
          cannot share, reuse, or derive from code used by another qualifying
          implementation. Sections of code that have no bearing on the
          implementation of this specification are exempt from this
          requirement.
        </dd>
        <dt>
          Interoperable
        </dt>
        <dd>
          Passing the respective test case(s) in the official test suite.
        </dd>
        <dt>
          Implementation
        </dt>
        <dd>
          A user agent which:
          <ol>
            <li>implements one of the conformance classes of the specification.
            </li>
            <li>is available to the general public. The implementation may be a
            shipping product or other publicly available version (i.e., beta
            version, preview release, or "nightly build"). Non-shipping product
            releases must have implemented the feature(s) for a period of at
            least one month in order to demonstrate stability.
            </li>
            <li>is not experimental (i.e. a version specifically designed to
            pass the test suite and not intended for normal usage going
            forward).
            </li>
          </ol>
        </dd>
      </dl>
    </section>
    <section class="appendix informative">
      <h2>
        Change log
      </h2>
      <p>
        This section lists changes made to the spec since it was first
        published as Candidate Recommendation in July 2016, with links to
        related issues on the group's issue tracker.
      </p>
      <section>
        <h3>
          Changes since 14 July 2016
        </h3>
        <ul>
          <li>Moved sandboxing flag checks to PresentationRequest constructor
          (<a href=
          "https://github.com/w3c/presentation-api/issues/379">#379</a>,
          <a href=
          "https://github.com/w3c/presentation-api/issues/398">#398</a>)
          </li>
          <li>Updated normative references to target stable specifications
          (<a href=
          "https://github.com/w3c/presentation-api/issues/295">#295</a>,
          <a href=
          "https://github.com/w3c/presentation-api/issues/396">#396</a>)
          </li>
          <li>Made display selection algorithm reject in ancestor and
          descendant browsing context (<a href=
          "https://github.com/w3c/presentation-api/issues/394">#394</a>)
          </li>
          <li>Renamed PresentationConnectionClosedReason to
          PresentationConnectionCloseReason (<a href=
          "https://github.com/w3c/presentation-api/issues/393">#393</a>)
          </li>
          <li>Fixed getAvailability and monitoring algorithms (<a href=
          "https://github.com/w3c/presentation-api/issues/335">#335</a>,
          <a href=
          "https://github.com/w3c/presentation-api/issues/381">#381</a>,
          <a href=
          "https://github.com/w3c/presentation-api/issues/382">#382</a>,
          <a href=
          "https://github.com/w3c/presentation-api/issues/383">#383</a>,
          <a href=
          "https://github.com/w3c/presentation-api/issues/387">#387</a>,
          <a href=
          "https://github.com/w3c/presentation-api/issues/388">#388</a>,
          <a href=
          "https://github.com/w3c/presentation-api/issues/392">#392</a>)
          </li>
          <li>Assigned correct JavaScript realm to re-used objects (<a href=
          "https://github.com/w3c/presentation-api/issues/391">#391</a>)
          </li>
          <li>Clarified display of insecure contexts in UX guidelines
            (<a href="https://github.com/w3c/presentation-api/issues/380">#380</a>)
          </li>
          <li>Set the state of receiving presentation connections to terminated
          before unload (<a href=
          "https://github.com/w3c/presentation-api/issues/374">#374</a>)
          </li>
          <li>Defined environment for nested contexts of the receiving browsing
          context (<a href=
          "https://github.com/w3c/presentation-api/issues/367">#367</a>)
          </li>
          <li>Removed [SameObject] for receiver (<a href=
          "https://github.com/w3c/presentation-api/issues/365">#365</a>)
          </li>
          <li>Replaced DOMString with USVString for PresentationRequest URLs
          (<a href=
          "https://github.com/w3c/presentation-api/issues/361">#361</a>)
          </li>
          <li>Added a presentation task source for events (<a href=
          "https://github.com/w3c/presentation-api/issues/360">#360</a>)
          </li>
          <li>Changed normative language around UUID generation (<a href=
          "https://github.com/w3c/presentation-api/issues/346">#346</a>)
          </li>
          <li>Added failure reason to close message (<a href=
          "https://github.com/w3c/presentation-api/issues/344">#344</a>)
          </li>
          <li>Added error handling to establish a presentation connection
          algorithm (<a href=
          "https://github.com/w3c/presentation-api/issues/343">#343</a>)
          </li>
          <li>Made navigator.presentation mandatory (<a href=
          "https://github.com/w3c/presentation-api/issues/341">#341</a>)
          </li>
          <li>Used current settings object in steps that require a settings
          object (<a href=
          "https://github.com/w3c/presentation-api/issues/336">#336</a>)
          </li>
          <li>Updated security check step to handle multiple URLs case
            (<a href="https://github.com/w3c/presentation-api/issues/329">#329</a>)
          </li>
          <li>Made PresentationConnection.id mandatory (<a href=
          "https://github.com/w3c/presentation-api/issues/325">#325</a>)
          </li>
          <li>Renamed PresentationConnectionClosedEvent to
          PresentationConnectionCloseEvent (<a href=
          "https://github.com/w3c/presentation-api/issues/324">#324</a>)
          </li>
          <li>Added an implementation note for advertising and rendering a user
          friendly display name (<a href=
          "https://github.com/w3c/presentation-api/issues/315">#315</a>)
          </li>
          <li>Added note for presentation detection (<a href=
          "https://github.com/w3c/presentation-api/issues/303">#303</a>)
          </li>
          <li>Various editorial updates (<a href=
          "https://github.com/w3c/presentation-api/issues/334">#334</a>,
          <a href=
          "https://github.com/w3c/presentation-api/issues/337">#337</a>,
          <a href=
          "https://github.com/w3c/presentation-api/issues/339">#339</a>,
          <a href=
          "https://github.com/w3c/presentation-api/issues/340">#340</a>,
          <a href=
          "https://github.com/w3c/presentation-api/issues/342">#342</a>,
          <a href=
          "https://github.com/w3c/presentation-api/issues/359">#359</a>,
          <a href=
          "https://github.com/w3c/presentation-api/issues/363">#363</a>,
          <a href=
          "https://github.com/w3c/presentation-api/issues/366">#366</a>,
          <a href=
          "https://github.com/w3c/presentation-api/issues/397">#397</a>)
          </li>
        </ul>
      </section>
    </section>
  </body>
</html>
